<!doctype html><html lang=zh dir=auto data-theme=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3988508441804851" crossorigin=anonymous></script><title>æ‰€æœ‰æ–‡ç«  | å…«æˆ’çš„æŠ€æœ¯åšå®¢</title>
<meta name=keywords content><meta name=description content="æ‰€æœ‰æ–‡ç«  - å…«æˆ’çš„æŠ€æœ¯åšå®¢"><meta name=author content><link rel=canonical href=https://rendoumi.com/posts/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.5d8a858b4ad07d913988e10d3c3dbc8c171f45316a396de8a60d67f44840812d.css integrity="sha256-XYqFi0rQfZE5iOENPD28jBcfRTFqOW3opg1n9EhAgS0=" rel="preload stylesheet" as=style><link rel=icon href=https://rendoumi.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://rendoumi.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://rendoumi.com/favicon-32x32.png><link rel=apple-touch-icon href=https://rendoumi.com/apple-touch-icon.png><link rel=mask-icon href=https://rendoumi.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://rendoumi.com/posts/index.xml title=rss><link rel=alternate hreflang=zh href=https://rendoumi.com/posts/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><meta property="og:url" content="https://rendoumi.com/posts/"><meta property="og:site_name" content="å…«æˆ’çš„æŠ€æœ¯åšå®¢"><meta property="og:title" content="æ‰€æœ‰æ–‡ç« "><meta property="og:locale" content="zh"><meta property="og:type" content="website"><meta name=twitter:card content="summary"><meta name=twitter:title content="æ‰€æœ‰æ–‡ç« "><meta name=twitter:description content><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"æ‰€æœ‰æ–‡ç« ","item":"https://rendoumi.com/posts/"}]}</script></head><body class=list id=top><header class=header><nav class=nav><div class=logo><a href=https://rendoumi.com/ accesskey=h title="å…«æˆ’çš„æŠ€æœ¯åšå®¢ (Alt + H)">å…«æˆ’çš„æŠ€æœ¯åšå®¢</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://rendoumi.com/ title=é¦–é¡µ><span>é¦–é¡µ</span></a></li><li><a href=https://rendoumi.com/posts/ title=æ–‡ç« ><span class=active>æ–‡ç« </span></a></li><li><a href=https://rendoumi.com/archives/ title=å½’æ¡£><span>å½’æ¡£</span></a></li><li><a href=https://blog.rendoumi.com title=ç”Ÿæ´»><span>ç”Ÿæ´»</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://rendoumi.com/search/ title=æœç´¢><span>æœç´¢</span></a></li></ul></nav></header><main class=main><header class=page-header><h1>æ‰€æœ‰æ–‡ç« </h1></header><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Javascriptsä¸­ifçš„ä¼˜åŒ–
<span class=entry-hint title=Draft><svg height="20" viewBox="0 -960 960 960" fill="currentcolor"><path d="M160-410v-60h3e2v60H160zm0-165v-60h470v60H160zm0-165v-60h470v60H160zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22-4.5 22.5T862.09-380L643-160H520zm3e2-263-37-37 37 37zM580-220h38l121-122-18-19-19-18-122 121v38zm141-141-19-18 37 37-18-19z"/></svg></span></h2></header><div class=entry-content><p>Javascripts ä¸­çš„ if â€¦ else ç”¨èµ·æ¥å€’æ˜¯å¾ˆæ–¹ä¾¿ï¼Œä½†æ˜¯çœ‹èµ·æ¥å°±ä¸èˆ’æœäº†
if (true) { } if (true) { } if (true) { if (true) { if (true) { } } else { } } else { } ä¸Šé¢çœ‹èµ·æ¥å¾ˆé—¹å¿ƒå§ï¼Œä¸‹é¢è®²è®²ä¼˜åŒ–ï¼š
ä¸€ã€ä¸‰å…ƒä¼˜åŒ– if (ture) elseå¯ä»¥ç”¨ä¸‰å…ƒæ“ä½œç¬¦æ¥ä¼˜åŒ–å®ƒï¼š
// Bad ğŸ˜¥ if (true) { console.log("Congratutions!") } else { console.warn("Oops, something went wrong!") } // Great ğŸ¥° true ? console.log("Congratutions") : console.warn("Oops, something went wrong!") äºŒã€ä¸ä¼˜åŒ– trueçš„æƒ…å†µä¸‹æ‰æ‰§è¡Œå¯ä»¥ç”¨ä¸æ¥è¿›è¡Œä¼˜åŒ–ï¼š
if (true) { alert(1) } // is equals to: true && alert(1) ä¸‰ã€æå‰è¿”å› å¦‚æœæœ‰å¤šä¸ªåˆ¤æ–­ï¼ŒæŒ‰ç…§å¤æ‚ç¨‹åº¦ï¼Œä»ä¸Šåˆ°ä¸‹ï¼Œæå‰è¿”å›ã€‚
...</p></div><footer class=entry-footer><span title='2022-06-15 09:30:11 +0800 CST'>2022å¹´6æœˆ15æ—¥</span></footer><a class=entry-link aria-label="post link to Javascriptsä¸­ifçš„ä¼˜åŒ–" href=https://rendoumi.com/posts/20220615-javascripts_if/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Shellè¿›é˜¶æŠ€å·§
<span class=entry-hint title=Draft><svg height="20" viewBox="0 -960 960 960" fill="currentcolor"><path d="M160-410v-60h3e2v60H160zm0-165v-60h470v60H160zm0-165v-60h470v60H160zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22-4.5 22.5T862.09-380L643-160H520zm3e2-263-37-37 37 37zM580-220h38l121-122-18-19-19-18-122 121v38zm141-141-19-18 37 37-18-19z"/></svg></span></h2></header><div class=entry-content><p>Shellè„šæœ¬çš„è¿›é˜¶æŠ€å·§ï¼š
ä¸€ã€String ç±»çš„æŠ€å·§ Stringç±»å½“ä½œæ•°ç»„æ¥ä½¿ç”¨ï¼Œæ³¨æ„èŒƒå›´çš„ä¸‹æ ‡ï¼Œ0:4ï¼Œ4æœ€åè¦è¢«è¸¢æ‰ï¼Œå®é™…æ˜¯0-3ï¼Œå…±4ä¸ªå­—ç¬¦ï¼š
string="Bash is great!" echo ${string:8} # great! echo ${string:0:4} # Bash echo ${string:8:-1} # great (-1: upto 1st element from right) æ•°ç»„çš„é•¿åº¦ï¼š
string="Bash is great!"; len=${#string} echo "len = $len" å­—ç¬¦ä¸²çš„æ›¿æ¢ï¼š
string="Bash is great!!" echo ${string/Bash/GNU Bash} # GNU Bash is great!! echo ${string//!/.} # Bash is great.. å¤§å°å†™æ›¿æ¢:
string="Bash" echo ${string^^} # BASH echo ${string,,} # bash æŒ‰indexå­˜å–æ•°ç»„ä¸­å­—ç¬¦åœ¨shellä¸­ä¸å¯ç”¨ï¼Œä½†æ˜¯å¯ä»¥ç”¨functionå˜ç›¸å®ç°ï¼š
function charAt() { string=$1 i=$2 echo ${string:i:1} } echo $(charAt "Hello" 2) # l echo $(charAt "Hello" 1) # e äºŒã€æ•°ç»„å’Œå­—å…¸ å®šä¹‰ä¸€ä¸ªæ•°ç»„å¹¶ä¸”éå†å®ƒï¼š
...</p></div><footer class=entry-footer><span title='2022-06-09 09:30:11 +0800 CST'>2022å¹´6æœˆ9æ—¥</span></footer><a class=entry-link aria-label="post link to Shellè¿›é˜¶æŠ€å·§" href=https://rendoumi.com/posts/20220609-shell_tips/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>javascriptsä¸­çš„promise
<span class=entry-hint title=Draft><svg height="20" viewBox="0 -960 960 960" fill="currentcolor"><path d="M160-410v-60h3e2v60H160zm0-165v-60h470v60H160zm0-165v-60h470v60H160zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22-4.5 22.5T862.09-380L643-160H520zm3e2-263-37-37 37 37zM580-220h38l121-122-18-19-19-18-122 121v38zm141-141-19-18 37 37-18-19z"/></svg></span></h2></header><div class=entry-content><p>ä¸€ã€åŸºæœ¬æ¦‚å¿µ
1. å¼‚æ­¥
æ‰€è°“ " å¼‚æ­¥ â€œï¼Œç®€å•è¯´å°±æ˜¯ä¸€ä¸ªä»»åŠ¡åˆ†æˆä¸¤æ®µï¼Œ å…ˆæ‰§è¡Œç¬¬ä¸€æ®µï¼Œ ç„¶åè½¬è€Œæ‰§è¡Œå…¶ä»–ä»»åŠ¡å»ï¼Œ ç­‰åšå¥½äº†å‡†å¤‡ï¼Œ å†å›è¿‡å¤´æ‰§è¡Œç¬¬äºŒæ®µã€‚
æ¯”å¦‚ï¼Œ æœ‰ä¸€ä¸ªä»»åŠ¡æ˜¯è¯»å–æ–‡ä»¶è¿›è¡Œå¤„ç†ï¼Œ ä»»åŠ¡çš„ç¬¬ä¸€æ®µæ˜¯å‘æ“ä½œç³»ç»Ÿå‘å‡ºè¯·æ±‚ï¼Œ è¦æ±‚è¯»å–æ–‡ä»¶ã€‚ ç„¶åï¼Œ ç¨‹åºæ‰§è¡Œå…¶ä»–ä»»åŠ¡ï¼Œ ç­‰åˆ°æ“ä½œç³»ç»Ÿè¿”å›æ–‡ä»¶ï¼Œå†æ¥ç€æ‰§è¡Œä»»åŠ¡çš„ç¬¬äºŒæ®µï¼ˆ å¤„ç†æ–‡ä»¶ï¼‰ã€‚ è¿™ç§ä¸è¿ç»­çš„æ‰§è¡Œï¼Œ å°±å«åšå¼‚æ­¥ã€‚
ç›¸åº”åœ°ï¼Œ è¿ç»­çš„æ‰§è¡Œå°±å«åšåŒæ­¥ã€‚ ç”±äºæ˜¯è¿ç»­æ‰§è¡Œï¼Œ ä¸èƒ½æ’å…¥å…¶ä»–ä»»åŠ¡ï¼Œ æ‰€ä»¥æ“ä½œç³»ç»Ÿä»ç¡¬ç›˜è¯»å–æ–‡ä»¶çš„è¿™æ®µæ—¶é—´ï¼Œ ç¨‹åºåªèƒ½å¹²ç­‰ç€ä»€ä¹ˆä¹Ÿåšä¸äº†ã€‚
2. å›è°ƒå‡½æ•°
javascript è¯­è¨€å¯¹å¼‚æ­¥ç¼–ç¨‹çš„å®ç°ï¼Œ å°±æ˜¯å›è°ƒå‡½æ•°ã€‚ æ‰€è°“å›è°ƒå‡½æ•°ï¼Œ å°±æ˜¯æŠŠä»»åŠ¡çš„ç¬¬äºŒæ®µå•ç‹¬å†™åœ¨ä¸€ä¸ªå‡½æ•°é‡Œé¢ï¼Œ ç­‰åˆ°å‡†å¤‡å¥½äº†ï¼Œç»§ç»­æ‰§è¡Œçš„æ—¶å€™ï¼Œ å°±ç›´æ¥è°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚ å®ƒçš„è‹±è¯­åå­— callbackï¼Œ ç›´è¯‘è¿‡æ¥å°±æ˜¯ " å›è°ƒ â€œã€‚
è¯»å–æ–‡ä»¶è¿›è¡Œå¤„ç†ï¼Œ æ˜¯è¿™æ ·çš„ï¼Œreadfile æ˜¯å¼‚æ­¥çš„ï¼ŒreadfileSync æ˜¯åŒæ­¥çš„ã€‚
fs.readfile('/etc/passwd', function(err, data) { if(err) throw err; console.log(data); }); ä¸Šé¢ä»£ç ä¸­ï¼Œ readfile å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œ å°±æ˜¯å›è°ƒå‡½æ•°ï¼Œ ä¹Ÿå°±æ˜¯ä»»åŠ¡çš„ç¬¬äºŒæ®µã€‚ ç­‰åˆ°æ“ä½œç³»ç»Ÿè¿”å›äº† / etc / passwdè¿™ä¸ªæ–‡ä»¶ä»¥åï¼Œ å›è°ƒå‡½æ•°æ‰ä¼šæ‰§è¡Œã€‚
==ä¸€ä¸ªæœ‰è¶£çš„é—®é¢˜æ˜¯ï¼Œ ä¸ºä»€ä¹ˆ node.js çº¦å®šï¼Œ å›è°ƒå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œ å¿…é¡»æ˜¯é”™è¯¯å¯¹è±¡ errï¼ˆ å¦‚æœæ²¡æœ‰é”™è¯¯ï¼Œ è¯¥å‚æ•°å°±æ˜¯ nullï¼‰ï¼Ÿ åŸå› æ˜¯æ‰§è¡Œåˆ†æˆä¸¤æ®µï¼Œ åœ¨è¿™ä¸¤æ®µä¹‹é—´æŠ›å‡ºçš„é”™è¯¯ï¼Œ ç¨‹åºæ— æ³•æ•æ‰ï¼Œ åªèƒ½å½“ä½œå‚æ•°ï¼Œ ä¼ å…¥ç¬¬äºŒæ®µã€‚==
...</p></div><footer class=entry-footer><span title='2022-05-24 09:30:11 +0800 CST'>2022å¹´5æœˆ24æ—¥</span></footer><a class=entry-link aria-label="post link to javascriptsä¸­çš„promise" href=https://rendoumi.com/posts/20220524-javascripts_promise/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>javascriptsä¸­çš„map
<span class=entry-hint title=Draft><svg height="20" viewBox="0 -960 960 960" fill="currentcolor"><path d="M160-410v-60h3e2v60H160zm0-165v-60h470v60H160zm0-165v-60h470v60H160zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22-4.5 22.5T862.09-380L643-160H520zm3e2-263-37-37 37 37zM580-220h38l121-122-18-19-19-18-122 121v38zm141-141-19-18 37 37-18-19z"/></svg></span></h2></header><div class=entry-content><p>Javascripts ä¸­çš„ map
è¯´åˆ°mapï¼Œå¦‚æœæˆ‘ä»¬æœ‰å¾ªç¯çš„è¯ï¼Œä¸åœéå†ï¼Œä¼šæŠŠæ—¶é—´ææˆ O(n)ã€‚å¦‚æœæœ‰mapï¼Œæ—¶é—´å°±å˜æˆäº†O(1)ï¼Œæ‰€ä»¥è¿˜æ˜¯ç›¸å½“æœ‰æ•ˆç‡çš„ã€‚
map æ˜¯ ES2015 ä¸­æ–°å¢åŠ çš„ï¼Œæ˜¯ä¸€ç§æ–°çš„ Object ç±»å‹ï¼Œå…è®¸å­˜æ”¾å„ç§ key-value å¯¹ã€‚
map æœ€å¤§çš„ç‰¹æ€§æ˜¯ï¼Œkey å¯ä»¥æ˜¯ä»»ä½•ç±»å‹ï¼ŒåŒ…æ‹¬ object å’Œ functionï¼›å¯ä»¥è°ƒç”¨ size å¾—åˆ° map çš„å¤§å°ï¼›è¿­ä»£çš„æ—¶å€™ï¼Œæ˜¯ä¸¥æ ¼æŒ‰ç…§æ·»åŠ çš„é¡ºåºè¿›è¡Œè¿­ä»£çš„ã€‚
map çš„æ–¹æ³•å¦‚ä¸‹ï¼š set, get, size, has, delete, clear:
let things = new Map(); const myFunc = () => 'ğŸ•'; things.set('ğŸš—', 'Car'); things.set('ğŸ ', 'House'); things.set('âœˆï¸', 'Airplane'); things.set(myFunc, 'ğŸ˜„ Key is a function!'); things.size; // 4 things.has('ğŸš—'); // true things.has(myFunc) // true things.has(() => 'ğŸ•'); // false, not the same reference things.get(myFunc); // 'ğŸ˜„ Key is a function!' things.delete('âœˆï¸'); things.has('âœˆï¸'); // false things.clear(); things.size; // 0 // setting key-value pairs is chainable things.set('ğŸ”§', 'Wrench') .set('ğŸ¸', 'Guitar') .set('ğŸ•¹', 'Joystick'); const myMap = new Map(); // Even another map can be a key things.set(myMap, 'Oh gosh!'); things.size; // 4 things.get(myMap); // 'Oh gosh!' è¿­ä»£å®ƒçš„æ–¹æ³•ï¼Œå¯ä»¥ç”¨ for â€¦ ofï¼Œé¡ºåºæ˜¯ä¸¥æ ¼æŒ‰ç…§ä½ æ’å…¥çš„é¡ºåºæ¥çš„ï¼š
...</p></div><footer class=entry-footer><span title='2022-05-23 09:30:11 +0800 CST'>2022å¹´5æœˆ23æ—¥</span></footer><a class=entry-link aria-label="post link to javascriptsä¸­çš„map" href=https://rendoumi.com/posts/20220523-javascripts_map/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>javascriptçš„å®é™…åº”ç”¨-fsæ¨¡å—
<span class=entry-hint title=Draft><svg height="20" viewBox="0 -960 960 960" fill="currentcolor"><path d="M160-410v-60h3e2v60H160zm0-165v-60h470v60H160zm0-165v-60h470v60H160zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22-4.5 22.5T862.09-380L643-160H520zm3e2-263-37-37 37 37zM580-220h38l121-122-18-19-19-18-122 121v38zm141-141-19-18 37 37-18-19z"/></svg></span></h2></header><div class=entry-content><p>åƒé‡Œä¹‹è¡Œå§‹äºè¶³ä¸‹ï¼Œjavascript æ¨¡å—æ¼«å¤©é£ï¼Œèƒ½åšçš„äº‹ä¹Ÿæ˜¯äº”èŠ±å…«é—¨ã€‚æˆ‘ä»¬æ¥å®è·µä¸€ä¸‹
å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š
é‡Œé¢æ˜¯ä¸€è¡Œè¡Œæ•°æ®ï¼Œæˆ‘ä»¬è¦åšçš„å°±æ˜¯æŠŠæ‰€æœ‰å€¼å–æ•´æ±‚å’Œï¼Œæ–‡ä»¶ä¸­æœ‰æŸäº›ç©ºè¡Œ
å¾ˆç®€å•ï¼Œç¨‹åºå¦‚ä¸‹ï¼š
var fs = require('fs'); calculate = () => { fs.readFile('data.txt', 'utf8', (err, data) => { if (err) { throw new Error(err) } const arr = data.split('\r\n'); const result = arr .filter(e => e) .map(parseFloat) .reduce((curr, next) => curr + next); console.log('RESULT: ', result); }); } è¶…çº§ç®€å•å§
å…³é”®å°±æ˜¯ä¸Šé¢çš„é“¾å¼è°ƒç”¨
split ç”¨æ¥åˆ†å‰²æ¯ä¸€è¡Œ filter ç”¨æ¥å»æ‰ç©ºè¡Œ map ç”¨æ¥æŠŠæ¯ä¸€è¡Œéƒ½è½¬åŒ–æˆæ•´æ•° reduce ç”¨æ¥æ±‚å’Œ</p></div><footer class=entry-footer><span title='2022-05-22 09:30:11 +0800 CST'>2022å¹´5æœˆ22æ—¥</span></footer><a class=entry-link aria-label="post link to javascriptçš„å®é™…åº”ç”¨-fsæ¨¡å—" href=https://rendoumi.com/posts/20220522-javascirpts_fs/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>javascriptsä¸­çš„module
<span class=entry-hint title=Draft><svg height="20" viewBox="0 -960 960 960" fill="currentcolor"><path d="M160-410v-60h3e2v60H160zm0-165v-60h470v60H160zm0-165v-60h470v60H160zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22-4.5 22.5T862.09-380L643-160H520zm3e2-263-37-37 37 37zM580-220h38l121-122-18-19-19-18-122 121v38zm141-141-19-18 37 37-18-19z"/></svg></span></h2></header><div class=entry-content><p>JavaScript Module æ˜¯ä»€ä¹ˆ ä¸€ä¸ª JavaScript module æ¨¡å—å‡†ç¡®çš„è¯´å°±æ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œå®ƒå…è®¸ä½ æŠŠä»£ç  export å¯¼å‡ºæ¥å¤ç”¨ï¼Œè¿™æ ·åˆ«çš„ JavaScript æ–‡ä»¶å¯ä»¥ import è¿™ä¸ªæ–‡ä»¶æŠŠå®ƒä½œä¸ºåº“æ–‡ä»¶æ¥ä½¿ç”¨äº†ã€‚
æ¨¡å—ä¸»è¦æ˜¯ç”¨åœ¨å·¥ç¨‹æ–‡ä»¶ä¸­ï¼Œç”¨æ¥æŠŠä»£ç å…±äº«ç»™å…¶ä»–æ–‡ä»¶ç”¨ï¼Œjavascipt çš„æ¨¡å—å¯ä»¥è¯´æ˜¯æ»¡å¤©é£ã€‚
è¿™é‡Œå‘¢è®¨è®ºçš„æ˜¯å‰ç«¯çš„éƒ¨åˆ†ï¼Œå³æ˜¯è¿è¡Œåœ¨æµè§ˆå™¨ä¸­çš„ javascripts module éƒ¨åˆ†ï¼Œè€Œä¸æ˜¯è¿è¡Œåœ¨åç«¯çš„ Node.js çš„éƒ¨åˆ†ï¼Œåç«¯ç°åœ¨å·²ç»å‘å‰ç«¯é æ‹¢äº†ã€‚
ES6æ ‡å‡†å‘å¸ƒåï¼Œmoduleæˆä¸ºæ ‡å‡†ï¼Œæ ‡å‡†ä½¿ç”¨æ˜¯ä»¥exportæŒ‡ä»¤å¯¼å‡ºæ¥å£ï¼Œä»¥importå¼•å…¥æ¨¡å—ï¼Œä½†æ˜¯åœ¨æˆ‘ä»¬ä¸€è´¯çš„nodeæ¨¡å—ä¸­ï¼Œæˆ‘ä»¬ä¾ç„¶é‡‡ç”¨çš„æ˜¯CommonJSè§„èŒƒï¼Œä½¿ç”¨requireå¼•å…¥æ¨¡å—ï¼Œä½¿ç”¨module.exportså¯¼å‡ºæ¥å£ã€‚è¿™ç‚¹ä¹Ÿç†è§£æ¸…æ¥šã€‚
æˆ‘ä»¬ä»é›¶æ¥ä¸€æ­¥æ­¥å¼€å§‹å§
å¦‚ä½•æŠŠä¸€ä¸ª JavaScript æ–‡ä»¶è½¬æ¢ä¸º ES çš„ module 1: åˆ›å»ºä¸€ä¸ª project ç›®å½• è¿™ä¸ªç›®å½•ç”¨æ¥æ”¾ HTML å’Œ JavaScript æ–‡ä»¶
2: å»ºç«‹ä½ çš„ code ä»£ç æ–‡ä»¶ åœ¨ project æ–‡ä»¶å¤¹ä¸­å»ºç«‹2ä¸ªæ–‡ä»¶:
index.html index.js 3: æ·»åŠ  JavaScript æ–‡ä»¶çš„å¼•ç”¨åˆ° HTML æ–‡ä»¶ä¸­ æ‰“å¼€index.html ç¼–è¾‘å®ƒï¼š
&lt;!DOCTYPE html> &lt;html> &lt;head> &lt;meta charset="UTF-8"> &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"> &lt;title>ES Module - zhang ranrui&lt;/title> &lt;/head> &lt;body> &lt;h1>ES Module Tutorial&lt;/h1> &lt;!-- Add the "index.js" JavaScript file to this HTML document --> &lt;script type="module" src="index.js">&lt;/script> &lt;/body> &lt;/html> ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å¼•ç”¨äº† index.js , å¹¶å®šä¹‰å®ƒ type=â€œmoduleâ€ï¼Œè¿™æ˜¾å¼æŒ‡æ˜äº† index.js æ˜¯ä¸€ä¸ª ES çš„moduleã€‚
...</p></div><footer class=entry-footer><span title='2022-05-21 09:30:11 +0800 CST'>2022å¹´5æœˆ21æ—¥</span></footer><a class=entry-link aria-label="post link to javascriptsä¸­çš„module" href=https://rendoumi.com/posts/20220521-javascripts_module/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Javascriptsä¹‹æ•°ç»„çš„reduce
<span class=entry-hint title=Draft><svg height="20" viewBox="0 -960 960 960" fill="currentcolor"><path d="M160-410v-60h3e2v60H160zm0-165v-60h470v60H160zm0-165v-60h470v60H160zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22-4.5 22.5T862.09-380L643-160H520zm3e2-263-37-37 37 37zM580-220h38l121-122-18-19-19-18-122 121v38zm141-141-19-18 37 37-18-19z"/></svg></span></h2></header><div class=entry-content><p>ç ”ç©¶ä¸€ä¸‹ javascripts çš„ reduce ï¼Œreduce æ˜¯æ—¢èƒ½æ”¹å˜ array çš„ sizeï¼Œåˆèƒ½æ”¹å˜æ•°å€¼çš„å‡½æ•°ï¼Œfilter æ˜¯åªèƒ½æ”¹å˜sizeï¼Œä¸èƒ½æ”¹å˜æ•°å€¼ï¼›è€Œ map æ˜¯ä¸èƒ½æ”¹å˜ sizeï¼Œå¯ä»¥æ”¹å˜æ•°å€¼ã€‚å¾ˆæ‹—å£å§ï¼Œä¸‰ä¸ªå…„å¼Ÿã€‚
ç®€å•ä»‹ç»ä¸€ä¸‹ reduceã€‚
å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªæ•°ç»„:
[1, 2, 3, 4] æˆ‘ä»¬è¦å¯¹æ•´ä¸ªæ•°ç»„æ±‚å’Œ.
reduce å®é™…æ˜¯æŒ‰ç…§ä¸‹åˆ—çš„ç®—å¼æ¥è¿›è¡Œæ±‚å’Œçš„:
((((1) + 2) + 3) + 4)
é‚£å®é™… reduce å‡½æ•°æ‰§è¡Œä¸­ï¼Œä½ å¯ä»¥æŒ‰ä½ éœ€æ±‚æ¥è‡ªå®šä¹‰ä½ è‡ªå·±çš„ + æ“ä½œç¬¦ã€‚æ•°ç»„çš„å€¼ä¹Ÿå¯ä»¥æ˜¯å…¶ä»–çš„ä»»æ„ä¸œè¥¿ã€‚å¬èµ·æ¥æœ‰ç‚¹æ„æ€å§ï¼Ÿ
1ã€ Reduce æ˜¯å¹²å˜›çš„ åœ¨ä¸€ä¸ªå‡½æ•°å¼ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œreduce å…¶å®æœ‰å¾ˆå¤šåˆ«çš„åç§°ï¼Œæ¯”å¦‚ foldï¼ˆå¯¹æŠ˜ï¼‰, accumulateï¼ˆç´¯åŠ å™¨ï¼‰, aggregateï¼ˆèšåˆå™¨ï¼‰, compressï¼ˆå‹ç¼©ï¼‰ ç”šè‡³å« injectï¼ˆæ³¨å…¥ï¼‰ã€‚
2ã€ Reduce çš„å‚æ•° å¸¸ç”¨ç”¨æ³•å¦‚ä¸‹ï¼š
let myArray = [/* é¦–å…ˆå®šä¹‰ä¸€ä¸ªæ•°ç»„ */]; let callbackfn = /* å†å®šä¹‰ä¸€ä¸ªå‡½æ•° */ ; let initialvalue = /* ä»»æ„ä¸€ä¸ªåˆå§‹åŒ–çš„å€¼ */ ; myArray.reduce(callbackfn) myArray.reduce(callbackfn, initialValue) reduce çš„å‚æ•°å¦‚ä¸‹:
callbackfn: å¿…é¡»æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¼šåœ¨æ•´ä¸ªæ•°ç»„ä¸­åå¤è°ƒç”¨ï¼Œreduce è°ƒç”¨ callbackfn çš„æ—¶å€™æœ‰4ä¸ªå‚æ•°ï¼Œæˆ‘ä»¬å®šä¹‰å®ƒä»¬æ˜¯ previousValue, currentElement, index å’Œ array ï¼Œçœ‹èµ·æ¥åƒä¸‹é¢ä¸€æ ·:
...</p></div><footer class=entry-footer><span title='2022-05-20 09:30:11 +0800 CST'>2022å¹´5æœˆ20æ—¥</span></footer><a class=entry-link aria-label="post link to Javascriptsä¹‹æ•°ç»„çš„reduce" href=https://rendoumi.com/posts/20220520-javascripts_reduce/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>é¢è¯•ä¹‹Dockerå¦‚ä½•æ‰“å‡ºæœ€å°çš„é•œåƒ
<span class=entry-hint title=Draft><svg height="20" viewBox="0 -960 960 960" fill="currentcolor"><path d="M160-410v-60h3e2v60H160zm0-165v-60h470v60H160zm0-165v-60h470v60H160zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22-4.5 22.5T862.09-380L643-160H520zm3e2-263-37-37 37 37zM580-220h38l121-122-18-19-19-18-122 121v38zm141-141-19-18 37 37-18-19z"/></svg></span></h2></header><div class=entry-content><p>é¢è¯•çš„æ—¶å€™è¢«é—®åˆ°ï¼šå¦‚ä½•æ‰èƒ½è®© docker æ‰“å‡ºçš„é•œåƒåŒ…å°½é‡å°ï¼Ÿ
å…¶å®åœ¨ç”Ÿäº§å·²ç»å°½é‡ä½¿ç”¨æœ€å°åŒ–çš„é•œåƒåŒ…äº†ï¼Œåªæ˜¯çªç„¶è¢«é—®åˆ°è¿˜æ˜¯æœ‰ç‚¹æ‡µåœˆï¼›å› ä¸ºå°è±¡ä¸­è‡ªå·±åŸºæœ¬æ˜¯ä½¿ç”¨ alphine åšåº•åŒ…ï¼ŒDockerfile é€šå¸¸å°±æ˜¯ copy ä¸€ä¸ªå¯æ‰§è¡Œçš„ç¨‹åºè¿›å»å°±å®Œäº‹äº†ï¼Œå¦‚æœä¸è¡Œï¼Œå†å¼€ shell è¿›å»æ…¢æ…¢æ·»åŠ ç¼ºå°‘çš„åº“æ–‡ä»¶ã€‚
è¿™é‡Œå°±æ€»ç»“ä¸€ä¸‹ï¼Œä¸¤ç‚¹ï¼š
ä¸€ã€ä½¿ç”¨å°½é‡å°çš„åº•åŒ… ä»¥ alphine ä¸ºä¸»ï¼Œä½¿ç”¨ alphine åº•åŒ…çš„æ—¶å€™ï¼Œéœ€è¦æ³¨æ„ä»¥ä¸‹ï¼š
1ã€æ›¿æ¢ apk çš„æº
2ã€æ›´æ–°ã€æ›´æ–°è¯ä¹¦
3ã€æ³¨æ„ Timezone çš„è®¾ç½®
4ã€æ³¨æ„ glibc åº“çš„å…¼å®¹é—®é¢˜
äºŒã€ä½¿ç”¨åˆ†é˜¶æ®µbuild é€šå¸¸ç±»ä¼¼cã€goã€rustä¹‹ç±»çš„æºä»£ç ï¼Œéƒ½éœ€è¦ç»è¿‡ç¼–è¯‘ï¼Œæœ€åäº§ç”Ÿå¯æ‰§è¡Œæ–‡ä»¶ï¼Œé‚£ä¹ˆå®Œæ•´çš„ç¼–è¯‘ç¯å¢ƒå…¶å®å¯¹æœ€åçš„é•œåƒæ¥è¯´éƒ½æ˜¯ä¸éœ€è¦çš„ã€‚
æ‰€ä»¥åˆ©ç”¨åˆ†é˜¶æ®µbuildï¼Œç”©è„±ç¼–è¯‘ç¯å¢ƒä»¥åŠä¸­é—´äº§ç‰©ï¼Œå°±å¯ä»¥ç¼©å°æœ€å build å‡ºé•œåƒçš„å¤§å°ï¼Œä½¿ç”¨ä¹Ÿå¾ˆç®€å•ã€‚
Dockerfile æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š
FROM golang:alpine AS build-env WORKDIR /app ADD . /app RUN cd /app && go build -o goapp FROM alpine RUN apk update && \ apk add ca-certificates && \ update-ca-certificates && \ rm -rf /var/cache/apk/* WORKDIR /app COPY --from=build-env /app/goapp /app EXPOSE 8080 ENTRYPOINT ./goapp</p></div><footer class=entry-footer><span title='2022-04-01 10:30:11 +0800 CST'>2022å¹´4æœˆ1æ—¥</span></footer><a class=entry-link aria-label="post link to é¢è¯•ä¹‹Dockerå¦‚ä½•æ‰“å‡ºæœ€å°çš„é•œåƒ" href=https://rendoumi.com/posts/20220401-docker_mini_image/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>é¢è¯•ä¹‹Nginxçš„epollçš„ä¼˜åŠ¿
<span class=entry-hint title=Draft><svg height="20" viewBox="0 -960 960 960" fill="currentcolor"><path d="M160-410v-60h3e2v60H160zm0-165v-60h470v60H160zm0-165v-60h470v60H160zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22-4.5 22.5T862.09-380L643-160H520zm3e2-263-37-37 37 37zM580-220h38l121-122-18-19-19-18-122 121v38zm141-141-19-18 37 37-18-19z"/></svg></span></h2></header><div class=entry-content><p>é¢è¯•æ—¶è¢«é—®åˆ°ï¼šæ˜¯å¦äº†è§£ Nginxï¼Œå®ƒä½¿ç”¨çš„ epoll æ¨¡å¼å’Œå…¶ä»–çš„ç›¸æ¯”æœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿ
ç›´æ¥è¢«é—®ä½ï¼Œå®é™…ç”Ÿäº§ä¸­é…è¿‡ä¸å°‘çš„ Nginxï¼Œå„ç§ rewriteã€regexã€æ­£åå‘ä»£ç†ã€phpã€fast-cgiã€é™æµã€è¯ä¹¦ã€jwtã€corsï¼›epoll åªå¤§æ¦‚æœ‰å°è±¡æ˜¯ä¸‹é¢è¿™è¡Œï¼š
events { use epoll; worker_connections 1024; } å®åœ¨æ˜¯æ±—é¢œå•Šï¼Œæ‰€ä»¥å¾—ä»”ç»†ç ”ç©¶ä¸€ä¸‹è¿™ä¸ª epollã€‚
é¦–å…ˆæ‰”æ¦‚å¿µ IOå¤šè·¯å¤ç”¨ï¼š å¤šè·¯æ˜¯æŒ‡ç½‘ç»œè¿æ¥ï¼Œå¤ç”¨æŒ‡çš„æ˜¯åŒä¸€ä¸ªçº¿ç¨‹ã€‚
IOå¤šè·¯å¤ç”¨æ˜¯ä¸€ç§åŒæ­¥IOæ¨¡å‹ï¼Œå®ç°ä¸€ä¸ªçº¿ç¨‹å¯ä»¥ç›‘è§†å¤šä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼›
ä¸€æ—¦æŸä¸ªæè¿°ç¬¦å°±ç»ªï¼ˆä¸€èˆ¬æ˜¯è¯»å°±ç»ªæˆ–è€…å†™å°±ç»ªï¼‰ï¼Œå°±èƒ½å¤Ÿé€šçŸ¥åº”ç”¨ç¨‹åºè¿›è¡Œç›¸åº”çš„è¯»å†™æ“ä½œï¼›
æ²¡æœ‰æ–‡ä»¶æè¿°ç¬¦å°±ç»ªæ—¶ä¼šé˜»å¡åº”ç”¨ç¨‹åºï¼Œäº¤å‡ºcpuã€‚
é‚£ä¹ˆIOå¤šè·¯å¤ç”¨çš„å®ç°æ–¹æ³•æœ‰ä¸‰ç§ï¼š selectã€pollã€epoll selectã€pollã€epollæœ¬è´¨ä¸Šéƒ½æ˜¯åŒæ­¥I/Oï¼Œç”¨æˆ·è¿›ç¨‹ï¼ˆè¿™é‡Œå°±æ˜¯Nginxï¼‰è´Ÿè´£è¯»å†™ï¼ˆä»å†…æ ¸ç©ºé—´æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´ï¼‰ï¼Œè¯»å†™è¿‡ç¨‹ä¸­ï¼Œç”¨æˆ·è¿›ç¨‹æ˜¯é˜»å¡çš„ã€‚
selectï¼š
æŸ¥è¯¢ fd_set ä¸­ï¼Œæ˜¯å¦æœ‰å°±ç»ªçš„ fdï¼Œå¯ä»¥è®¾å®šä¸€ä¸ªè¶…æ—¶æ—¶é—´ï¼Œå½“æœ‰ fd (File descripter) å°±ç»ªæˆ–è¶…æ—¶è¿”å›ï¼›
fd_set æ˜¯ä¸€ä¸ªä½é›†åˆï¼Œå¤§å°æ˜¯åœ¨ç¼–è¯‘å†…æ ¸æ—¶çš„å¸¸é‡ï¼Œé»˜è®¤å¤§å°ä¸º 1024
ç‰¹ç‚¹ï¼š
è¿æ¥æ•°é™åˆ¶ï¼Œfd_set å¯è¡¨ç¤ºçš„ fd æ•°é‡å¤ªå°äº†ï¼›
çº¿æ€§æ‰«æï¼šåˆ¤æ–­ fd æ˜¯å¦å°±ç»ªï¼Œéœ€è¦éå†ä¸€è¾¹ fd_setï¼›
æ•°æ®å¤åˆ¶ï¼šä»å†…æ ¸ç©ºé—´æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´ï¼Œå¤åˆ¶è¿æ¥å°±ç»ªçŠ¶æ€ä¿¡æ¯
pollï¼š
è§£å†³äº†è¿æ¥æ•°é™åˆ¶ï¼š
poll ä¸­å°† select ä¸­çš„ fd_set æ›¿æ¢æˆäº†ä¸€ä¸ª pollfd æ•°ç»„
è§£å†³ fd æ•°é‡è¿‡å°çš„é—®é¢˜
æ•°æ®å¤åˆ¶ï¼šä»å†…æ ¸ç©ºé—´æ‹·è´åˆ°ç”¨æˆ·ç©ºé—´ï¼Œå¤åˆ¶è¿æ¥å°±ç»ªçŠ¶æ€ä¿¡æ¯
epollï¼ševent äº‹ä»¶é©±åŠ¨
äº‹ä»¶æœºåˆ¶ï¼šé¿å…çº¿æ€§æ‰«æ
ä¸ºæ¯ä¸ª fdï¼Œæ³¨å†Œä¸€ä¸ªç›‘å¬äº‹ä»¶
fd å˜æ›´ä¸ºå°±ç»ªæ—¶ï¼Œå°† fd æ·»åŠ åˆ°å°±ç»ªé“¾è¡¨
...</p></div><footer class=entry-footer><span title='2022-04-01 09:30:11 +0800 CST'>2022å¹´4æœˆ1æ—¥</span></footer><a class=entry-link aria-label="post link to é¢è¯•ä¹‹Nginxçš„epollçš„ä¼˜åŠ¿" href=https://rendoumi.com/posts/20220401-nginx_epoll/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Kubernetesä¸‹Flannelç½‘ç»œ
<span class=entry-hint title=Draft><svg height="20" viewBox="0 -960 960 960" fill="currentcolor"><path d="M160-410v-60h3e2v60H160zm0-165v-60h470v60H160zm0-165v-60h470v60H160zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22-4.5 22.5T862.09-380L643-160H520zm3e2-263-37-37 37 37zM580-220h38l121-122-18-19-19-18-122 121v38zm141-141-19-18 37 37-18-19z"/></svg></span></h2></header><div class=entry-content><p>ç°åœ¨å„å¤§å…¬æœ‰äº‘çš„ k8s ç½‘ç»œæ’ä»¶åŸºæœ¬ç”¨çš„éƒ½æ˜¯ vxlanï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦å¯¹è¿™ä¸ªè¿›è¡Œä¸€ä¸‹è¯¦ç»†äº†è§£ï¼Œä»¥ä¾¿ç”¨äºå…¬å¸çš„æ­£å¼ç”Ÿäº§ç¯å¢ƒã€‚
ä¸€ã€åŸç† é¦–å…ˆï¼Œkubernetesçš„ç½‘ç»œæ¨¡å‹ï¼š
åŒ…å«ä¸‰è¦ç´ ï¼š
æ‰€æœ‰çš„å®¹å™¨(container)ä¹‹é—´èƒ½å¤Ÿåœ¨ä¸ä½¿ç”¨ NAT çš„æƒ…å†µä¸‹äº’ç›¸é€šè®¯
æ‰€æœ‰çš„èŠ‚ç‚¹(Node)èƒ½å¤Ÿåœ¨ä¸ä½¿ç”¨ NAT çš„æƒ…å†µä¸‹è·Ÿæ‰€æœ‰çš„å®¹å™¨(container)äº’ç›¸é€šè®¯ï¼ˆåä¹‹å®¹å™¨è®¿é—®èŠ‚ç‚¹äº¦ç„¶ï¼‰
å®¹å™¨(container)ä¸­çš„IPåœ°å€ï¼Œåœ¨å®¹å™¨å†…å’Œå®¹å™¨å¤–é¢çœ‹èµ·æ¥æ˜¯ä¸€æ ·çš„
é‚£æ¥åˆ° flannelï¼Œå®ƒæ˜¯ä¸€ç§ Overlay network è¦†ç›–ç½‘ç»œï¼Œç›–åœ¨åŸæœ‰çš„ Node ç½‘ç»œåŸºç¡€ä¸Šï¼š ä¸Šå›¾è¦ä»”ç»†åˆ†æï¼Œ K8S ä¸­å­˜åœ¨ä¸‰ä¸ª+ä¸€ä¸ªç½‘ç»œæ®µï¼š
node ç½‘ç»œæ®µï¼Œä¸Šå›¾æ˜¯ 172.20.32.0/19ï¼Œè¿™æ˜¯åŸºç¡€ç½‘ç»œæ®µ pod ç½‘ç»œæ®µï¼Œ100.96.0.0/16ï¼Œ2Â¹â¶(65536)ä¸ªIPï¼Œè¿™æ˜¯ç”± flannel äº§ç”Ÿçš„ overlay networkï¼Œæ‰€æœ‰çš„ pod éƒ½ç«™åœ¨ä¸€ä¸ªå¤§å¹¿åœºä¸Šï¼Œäº’ç›¸å¯è§ svc ç½‘ç»œæ®µï¼Œä¸Šå›¾æœªæï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“ï¼Œæƒ³è¦æŠŠ pod çš„ ip ç»™å›ºå®šä¸‹æ¥ï¼Œå°±å¾—ä½¿ç”¨ svc æ¥åˆ†é…å›ºå®šçš„åŸŸåï¼Œè¿™ä¸ªæ˜¯ç”± iptables æ¥ç»´æŠ¤çš„ In-Host docker networkç½‘ç»œæ®µï¼Œè¿™æ˜¯æ¯ä¸ª Node ä¸»æœºçš„å•ç‹¬ç½‘ç»œæ®µï¼Œflannelç»™æ¯ä¸ª Node ä¸»æœºåˆ’åˆ†äº†ä¸€ä¸ª 100.96.x.0/24 æ®µï¼Œç„¶ååœ¨ etcd å†…è¿›è¡Œç»´æŠ¤ï¼Œæ¥é¿å…ä¸åŒçš„ Node ä¸»æœºåˆ†é…IPå†²çªã€‚ ç»¼è¿°ï¼šflannel ä¸ºæ¯ä¸ª Node åˆ†é…ä¸€ä¸ª subnetï¼Œå®¹å™¨(container)ä»æ­¤ subnet ä¸­åˆ†é… IPï¼Œè¿™äº› IP å¯ä»¥åœ¨ Node é—´è·¯ç”±ï¼Œå®¹å™¨é—´æ— éœ€ NAT å’Œ port mapping å°±å¯ä»¥è·¨ä¸»æœºé€šä¿¡ã€‚
...</p></div><footer class=entry-footer><span title='2022-03-17 09:30:11 +0800 CST'>2022å¹´3æœˆ17æ—¥</span></footer><a class=entry-link aria-label="post link to Kubernetesä¸‹Flannelç½‘ç»œ" href=https://rendoumi.com/posts/20220317-kubernetes_flannel/></a></article><div class=pagination><ul class=pagination-list><li class="page-item first"><a class=page-link href=/posts/ aria-label="First Page"><span aria-hidden=true>&#9668;</span></a></li><li class="page-item prev"><a class=page-link href=/posts/page/27/ aria-label=Previous><span aria-hidden=true>&#171;</span></a></li><li class=page-item><a class=page-link href=/posts/page/25/>25</a></li><li class=page-item><a class=page-link href=/posts/page/26/>26</a></li><li class=page-item><a class=page-link href=/posts/page/27/>27</a></li><li class="page-item active"><span class=page-link aria-current=page>28</span></li><li class=page-item><a class=page-link href=/posts/page/29/>29</a></li><li class=page-item><a class=page-link href=/posts/page/30/>30</a></li><li class=page-item><a class=page-link href=/posts/page/31/>31</a></li><li class=page-item><a class=page-link href=/posts/page/32/>32</a></li><li class="page-item next"><a class=page-link href=/posts/page/29/ aria-label=Next><span aria-hidden=true>&#187;</span></a></li><li class="page-item last"><a class=page-link href=/posts/page/35/ aria-label="Last Page"><span aria-hidden=true>&#9658;</span></a></li></ul><div class=total-pages>å…± 35 é¡µ</div></div></main><footer class=footer><span>Copyright Â© 2020-2025 Zhang Ranrui. All Rights Reserved.</span><br>Â·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script></body></html>