<!doctype html><html lang=zh dir=auto data-theme=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3988508441804851" crossorigin=anonymous></script><title>Claude code的skills编写 | 八戒的技术博客</title>
<meta name=keywords content><meta name=description content='最近天天都在学习claude code，Skills == 工具箱（技能库）
我们可以把skills看成是一个个的小程序，这些程序有入口，有参数，有限制。
那通过一篇md文件，来引导claude来智能的传参调用你的程序，这样技能箱就越来越丰富。
一、我们首先准备这个可执行 python 脚本
这个是通过CLIProxyAPI的反代，把antigravity的gemini3模型给抽出来，然后生图
看最下面，有一堆参数
#!/usr/bin/env python3
# ============================================================
# Configuration - Edit these values before use
# 配置项 - 使用前请修改以下值
# ============================================================
API_BASE_URL = "http://127.0.0.1:8317"  # API server address / API 服务器地址
API_KEY = "key"                          # Your API key / 你的 API 密钥
MODEL = "gemini-3-pro-image-preview"     # Model name / 模型名称
# ============================================================

import argparse
import base64
import json
import os
import sys
from datetime import datetime
from pathlib import Path
from urllib import request
from mimetypes import guess_type

try:
    from google import genai
    from google.genai import types
except ImportError:
    genai = None
    types = None

VALID_ASPECT_RATIOS = ["1:1", "2:3", "3:2", "3:4", "4:3", "4:5", "5:4", "9:16", "16:9", "21:9"]
VALID_RESOLUTIONS = ["1K", "2K", "4K"]


def _resolve_output_dir(output_dir: str, mkdir: bool) -> str:
    if os.path.isdir(output_dir):
        return output_dir
    if mkdir:
        os.makedirs(output_dir, exist_ok=True)
        return output_dir
    print(f"Warning: Output directory not found: {output_dir}. Saving to current directory.")
    return "."


def _build_filename(output_name: str | None, timestamp: str, index: int, default_ext: str) -> str:
    if output_name:
        root, ext = os.path.splitext(output_name)
        if not ext:
            ext = default_ext
        suffix = f"_{index}" if index > 0 else ""
        return f"{root}{suffix}{ext}"
    return f"generated_{timestamp}_{index}{default_ext}"


def _load_image_inline(image_path: str) -> dict:
    mime_type, _ = guess_type(image_path)
    if mime_type is None:
        mime_type = "image/png"
    data = Path(image_path).read_bytes()
    return {"inlineData": {"mimeType": mime_type, "data": base64.b64encode(data).decode("ascii")}}


def _post_json(url: str, body: dict) -> dict:
    data = json.dumps(body).encode("utf-8")
    req = request.Request(
        url,
        data=data,
        headers={"Content-Type": "application/json", "x-goog-api-key": API_KEY},
    )
    resp = request.urlopen(req).read()
    return json.loads(resp)


def _save_images(parts, output_dir: str, select: str, output_name: str | None, mkdir: bool) -> list[str]:
    imgs = [p["inlineData"] for p in parts if "inlineData" in p]
    if not imgs:
        return []

    if select == "first":
        imgs = imgs[:1]
    elif select == "last":
        imgs = imgs[-1:]
    elif select == "max_res":
        imgs = imgs[-1:]

    ts = datetime.now().strftime("%Y%m%d_%H%M%S")
    output_dir = _resolve_output_dir(output_dir, mkdir)
    saved = []
    for i, img in enumerate(imgs):
        data = base64.b64decode(img["data"])
        ext = "jpg" if img.get("mimeType", "").endswith("jpeg") else "png"
        filename = _build_filename(output_name, ts, i, f".{ext}")
        path = Path(output_dir) / filename
        path.write_bytes(data)
        saved.append(str(path))
    return saved


def _sdk_generate(prompt: str, output_dir: str, aspect_ratio: str, resolution: str, input_image: str | None,
                  output_name: str | None, mkdir: bool, select: str) -> list[str]:
    if genai is None or types is None:
        print("Error: google-genai is not installed.")
        return []

    client_kwargs = {"api_key": API_KEY}
    if API_BASE_URL:
        client_kwargs["http_options"] = {"base_url": API_BASE_URL}
    client = genai.Client(**client_kwargs)

    if input_image:
        if not Path(input_image).exists():
            print(f"Error: Input image not found: {input_image}")
            return []
        with open(input_image, "rb") as f:
            image_bytes = f.read()
        mime_type, _ = guess_type(input_image)
        if mime_type is None:
            mime_type = "image/png"
        image_part = types.Part.from_bytes(data=image_bytes, mime_type=mime_type)
        contents = [prompt, image_part]
    else:
        contents = prompt

    try:
        response = client.models.generate_content(
            model=MODEL,
            contents=contents,
            config=types.GenerateContentConfig(
                image_config=types.ImageConfig(
                    aspectRatio=aspect_ratio,
                    imageSize=resolution,
                )
            ),
        )
    except Exception as exc:
        print(f"API Error: {exc}")
        return []

    saved = []
    ts = datetime.now().strftime("%Y%m%d_%H%M%S")
    output_dir = _resolve_output_dir(output_dir, mkdir)
    image_parts = []
    for part in response.parts:
        if part.text is not None:
            print(f"Response text: {part.text}")
        elif image := part.as_image():
            image_parts.append(image)

    if not image_parts:
        return []

    if select == "first":
        image_parts = image_parts[:1]
    elif select == "last":
        image_parts = image_parts[-1:]
    elif select == "max_res":
        image_parts = [max(image_parts, key=lambda x: len(x.image_bytes))]

    for i, image in enumerate(image_parts):
        filename = _build_filename(output_name, ts, i, ".png")
        path = Path(output_dir) / filename
        image.save(path)
        saved.append(str(path))
    return saved


def _http_generate(prompt: str, output_dir: str, aspect_ratio: str, resolution: str, input_image: str | None,
                   select: str, output_name: str | None, mkdir: bool) -> list[str]:
    if input_image and not Path(input_image).exists():
        print(f"Error: Input image not found: {input_image}")
        return []

    url = f"{API_BASE_URL.rstrip(&#39;/&#39;)}/v1beta/models/{MODEL}:generateContent"
    parts = [{"text": prompt}]
    if input_image:
        parts.append(_load_image_inline(input_image))

    body = {
        "contents": [{"parts": parts}],
        "generationConfig": {
            "responseModalities": ["TEXT", "IMAGE"],
            "imageConfig": {"aspectRatio": aspect_ratio, "imageSize": resolution},
        },
    }

    try:
        resp = _post_json(url, body)
    except Exception as exc:
        print(f"API Error: {exc}")
        return []

    if "candidates" not in resp:
        print(f"Unexpected response: {resp}")
        return []

    parts_out = resp["candidates"][0]["content"]["parts"]
    return _save_images(parts_out, output_dir, select, output_name, mkdir)


def main():
    parser = argparse.ArgumentParser(description="Generate images via SDK or HTTP")
    parser.add_argument("prompt", nargs="*", help="Image description prompt")
    parser.add_argument("--mode", default="sdk", choices=["sdk", "http"])
    parser.add_argument("--aspect-ratio", "-a", default="16:9", choices=VALID_ASPECT_RATIOS)
    parser.add_argument("--resolution", "-r", default="4K", choices=VALID_RESOLUTIONS)
    parser.add_argument("--output-dir", "-o", default=".")
    parser.add_argument("--output-name", default=None)
    parser.add_argument("--mkdir", action="store_true")
    parser.add_argument("--input-image", "-i", default=None)
    parser.add_argument("--select", default="all", choices=["all", "first", "last", "max_res"])

    args = parser.parse_args()
    if not args.prompt:
        parser.print_help()
        sys.exit(1)

    prompt = " ".join(args.prompt)

    if args.mode == "sdk":
        saved = _sdk_generate(
            prompt=prompt,
            output_dir=args.output_dir,
            aspect_ratio=args.aspect_ratio,
            resolution=args.resolution,
            input_image=args.input_image,
            output_name=args.output_name,
            mkdir=args.mkdir,
            select=args.select,
        )
    else:
        saved = _http_generate(
            prompt=prompt,
            output_dir=args.output_dir,
            aspect_ratio=args.aspect_ratio,
            resolution=args.resolution,
            input_image=args.input_image,
            select=args.select,
            output_name=args.output_name,
            mkdir=args.mkdir,
        )

    if saved:
        print(f"Generated {len(saved)} image(s):")
        for f in saved:
            print(f"  - {Path(f).resolve()}")
    else:
        print("No images were generated.")
        sys.exit(1)


if __name__ == "__main__":
    main()
基本用法：'><meta name=author content><link rel=canonical href=https://rendoumi.com/posts/20251231-claude_skills/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.5d8a858b4ad07d913988e10d3c3dbc8c171f45316a396de8a60d67f44840812d.css integrity="sha256-XYqFi0rQfZE5iOENPD28jBcfRTFqOW3opg1n9EhAgS0=" rel="preload stylesheet" as=style><link rel=icon href=https://rendoumi.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://rendoumi.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://rendoumi.com/favicon-32x32.png><link rel=apple-touch-icon href=https://rendoumi.com/apple-touch-icon.png><link rel=mask-icon href=https://rendoumi.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh href=https://rendoumi.com/posts/20251231-claude_skills/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><meta property="og:url" content="https://rendoumi.com/posts/20251231-claude_skills/"><meta property="og:site_name" content="八戒的技术博客"><meta property="og:title" content="Claude code的skills编写"><meta property="og:description" content='最近天天都在学习claude code，Skills == 工具箱（技能库）
我们可以把skills看成是一个个的小程序，这些程序有入口，有参数，有限制。
那通过一篇md文件，来引导claude来智能的传参调用你的程序，这样技能箱就越来越丰富。
一、我们首先准备这个可执行 python 脚本 这个是通过CLIProxyAPI的反代，把antigravity的gemini3模型给抽出来，然后生图
看最下面，有一堆参数
#!/usr/bin/env python3 # ============================================================ # Configuration - Edit these values before use # 配置项 - 使用前请修改以下值 # ============================================================ API_BASE_URL = "http://127.0.0.1:8317" # API server address / API 服务器地址 API_KEY = "key" # Your API key / 你的 API 密钥 MODEL = "gemini-3-pro-image-preview" # Model name / 模型名称 # ============================================================ import argparse import base64 import json import os import sys from datetime import datetime from pathlib import Path from urllib import request from mimetypes import guess_type try: from google import genai from google.genai import types except ImportError: genai = None types = None VALID_ASPECT_RATIOS = ["1:1", "2:3", "3:2", "3:4", "4:3", "4:5", "5:4", "9:16", "16:9", "21:9"] VALID_RESOLUTIONS = ["1K", "2K", "4K"] def _resolve_output_dir(output_dir: str, mkdir: bool) -> str: if os.path.isdir(output_dir): return output_dir if mkdir: os.makedirs(output_dir, exist_ok=True) return output_dir print(f"Warning: Output directory not found: {output_dir}. Saving to current directory.") return "." def _build_filename(output_name: str | None, timestamp: str, index: int, default_ext: str) -> str: if output_name: root, ext = os.path.splitext(output_name) if not ext: ext = default_ext suffix = f"_{index}" if index > 0 else "" return f"{root}{suffix}{ext}" return f"generated_{timestamp}_{index}{default_ext}" def _load_image_inline(image_path: str) -> dict: mime_type, _ = guess_type(image_path) if mime_type is None: mime_type = "image/png" data = Path(image_path).read_bytes() return {"inlineData": {"mimeType": mime_type, "data": base64.b64encode(data).decode("ascii")}} def _post_json(url: str, body: dict) -> dict: data = json.dumps(body).encode("utf-8") req = request.Request( url, data=data, headers={"Content-Type": "application/json", "x-goog-api-key": API_KEY}, ) resp = request.urlopen(req).read() return json.loads(resp) def _save_images(parts, output_dir: str, select: str, output_name: str | None, mkdir: bool) -> list[str]: imgs = [p["inlineData"] for p in parts if "inlineData" in p] if not imgs: return [] if select == "first": imgs = imgs[:1] elif select == "last": imgs = imgs[-1:] elif select == "max_res": imgs = imgs[-1:] ts = datetime.now().strftime("%Y%m%d_%H%M%S") output_dir = _resolve_output_dir(output_dir, mkdir) saved = [] for i, img in enumerate(imgs): data = base64.b64decode(img["data"]) ext = "jpg" if img.get("mimeType", "").endswith("jpeg") else "png" filename = _build_filename(output_name, ts, i, f".{ext}") path = Path(output_dir) / filename path.write_bytes(data) saved.append(str(path)) return saved def _sdk_generate(prompt: str, output_dir: str, aspect_ratio: str, resolution: str, input_image: str | None, output_name: str | None, mkdir: bool, select: str) -> list[str]: if genai is None or types is None: print("Error: google-genai is not installed.") return [] client_kwargs = {"api_key": API_KEY} if API_BASE_URL: client_kwargs["http_options"] = {"base_url": API_BASE_URL} client = genai.Client(**client_kwargs) if input_image: if not Path(input_image).exists(): print(f"Error: Input image not found: {input_image}") return [] with open(input_image, "rb") as f: image_bytes = f.read() mime_type, _ = guess_type(input_image) if mime_type is None: mime_type = "image/png" image_part = types.Part.from_bytes(data=image_bytes, mime_type=mime_type) contents = [prompt, image_part] else: contents = prompt try: response = client.models.generate_content( model=MODEL, contents=contents, config=types.GenerateContentConfig( image_config=types.ImageConfig( aspectRatio=aspect_ratio, imageSize=resolution, ) ), ) except Exception as exc: print(f"API Error: {exc}") return [] saved = [] ts = datetime.now().strftime("%Y%m%d_%H%M%S") output_dir = _resolve_output_dir(output_dir, mkdir) image_parts = [] for part in response.parts: if part.text is not None: print(f"Response text: {part.text}") elif image := part.as_image(): image_parts.append(image) if not image_parts: return [] if select == "first": image_parts = image_parts[:1] elif select == "last": image_parts = image_parts[-1:] elif select == "max_res": image_parts = [max(image_parts, key=lambda x: len(x.image_bytes))] for i, image in enumerate(image_parts): filename = _build_filename(output_name, ts, i, ".png") path = Path(output_dir) / filename image.save(path) saved.append(str(path)) return saved def _http_generate(prompt: str, output_dir: str, aspect_ratio: str, resolution: str, input_image: str | None, select: str, output_name: str | None, mkdir: bool) -> list[str]: if input_image and not Path(input_image).exists(): print(f"Error: Input image not found: {input_image}") return [] url = f"{API_BASE_URL.rstrip(&#39;/&#39;)}/v1beta/models/{MODEL}:generateContent" parts = [{"text": prompt}] if input_image: parts.append(_load_image_inline(input_image)) body = { "contents": [{"parts": parts}], "generationConfig": { "responseModalities": ["TEXT", "IMAGE"], "imageConfig": {"aspectRatio": aspect_ratio, "imageSize": resolution}, }, } try: resp = _post_json(url, body) except Exception as exc: print(f"API Error: {exc}") return [] if "candidates" not in resp: print(f"Unexpected response: {resp}") return [] parts_out = resp["candidates"][0]["content"]["parts"] return _save_images(parts_out, output_dir, select, output_name, mkdir) def main(): parser = argparse.ArgumentParser(description="Generate images via SDK or HTTP") parser.add_argument("prompt", nargs="*", help="Image description prompt") parser.add_argument("--mode", default="sdk", choices=["sdk", "http"]) parser.add_argument("--aspect-ratio", "-a", default="16:9", choices=VALID_ASPECT_RATIOS) parser.add_argument("--resolution", "-r", default="4K", choices=VALID_RESOLUTIONS) parser.add_argument("--output-dir", "-o", default=".") parser.add_argument("--output-name", default=None) parser.add_argument("--mkdir", action="store_true") parser.add_argument("--input-image", "-i", default=None) parser.add_argument("--select", default="all", choices=["all", "first", "last", "max_res"]) args = parser.parse_args() if not args.prompt: parser.print_help() sys.exit(1) prompt = " ".join(args.prompt) if args.mode == "sdk": saved = _sdk_generate( prompt=prompt, output_dir=args.output_dir, aspect_ratio=args.aspect_ratio, resolution=args.resolution, input_image=args.input_image, output_name=args.output_name, mkdir=args.mkdir, select=args.select, ) else: saved = _http_generate( prompt=prompt, output_dir=args.output_dir, aspect_ratio=args.aspect_ratio, resolution=args.resolution, input_image=args.input_image, select=args.select, output_name=args.output_name, mkdir=args.mkdir, ) if saved: print(f"Generated {len(saved)} image(s):") for f in saved: print(f" - {Path(f).resolve()}") else: print("No images were generated.") sys.exit(1) if __name__ == "__main__": main() 基本用法：'><meta property="og:locale" content="zh"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-12-31T09:40:01+08:00"><meta property="article:modified_time" content="2025-12-31T09:40:01+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Claude code的skills编写"><meta name=twitter:description content='最近天天都在学习claude code，Skills == 工具箱（技能库）
我们可以把skills看成是一个个的小程序，这些程序有入口，有参数，有限制。
那通过一篇md文件，来引导claude来智能的传参调用你的程序，这样技能箱就越来越丰富。
一、我们首先准备这个可执行 python 脚本
这个是通过CLIProxyAPI的反代，把antigravity的gemini3模型给抽出来，然后生图
看最下面，有一堆参数
#!/usr/bin/env python3
# ============================================================
# Configuration - Edit these values before use
# 配置项 - 使用前请修改以下值
# ============================================================
API_BASE_URL = "http://127.0.0.1:8317"  # API server address / API 服务器地址
API_KEY = "key"                          # Your API key / 你的 API 密钥
MODEL = "gemini-3-pro-image-preview"     # Model name / 模型名称
# ============================================================

import argparse
import base64
import json
import os
import sys
from datetime import datetime
from pathlib import Path
from urllib import request
from mimetypes import guess_type

try:
    from google import genai
    from google.genai import types
except ImportError:
    genai = None
    types = None

VALID_ASPECT_RATIOS = ["1:1", "2:3", "3:2", "3:4", "4:3", "4:5", "5:4", "9:16", "16:9", "21:9"]
VALID_RESOLUTIONS = ["1K", "2K", "4K"]


def _resolve_output_dir(output_dir: str, mkdir: bool) -> str:
    if os.path.isdir(output_dir):
        return output_dir
    if mkdir:
        os.makedirs(output_dir, exist_ok=True)
        return output_dir
    print(f"Warning: Output directory not found: {output_dir}. Saving to current directory.")
    return "."


def _build_filename(output_name: str | None, timestamp: str, index: int, default_ext: str) -> str:
    if output_name:
        root, ext = os.path.splitext(output_name)
        if not ext:
            ext = default_ext
        suffix = f"_{index}" if index > 0 else ""
        return f"{root}{suffix}{ext}"
    return f"generated_{timestamp}_{index}{default_ext}"


def _load_image_inline(image_path: str) -> dict:
    mime_type, _ = guess_type(image_path)
    if mime_type is None:
        mime_type = "image/png"
    data = Path(image_path).read_bytes()
    return {"inlineData": {"mimeType": mime_type, "data": base64.b64encode(data).decode("ascii")}}


def _post_json(url: str, body: dict) -> dict:
    data = json.dumps(body).encode("utf-8")
    req = request.Request(
        url,
        data=data,
        headers={"Content-Type": "application/json", "x-goog-api-key": API_KEY},
    )
    resp = request.urlopen(req).read()
    return json.loads(resp)


def _save_images(parts, output_dir: str, select: str, output_name: str | None, mkdir: bool) -> list[str]:
    imgs = [p["inlineData"] for p in parts if "inlineData" in p]
    if not imgs:
        return []

    if select == "first":
        imgs = imgs[:1]
    elif select == "last":
        imgs = imgs[-1:]
    elif select == "max_res":
        imgs = imgs[-1:]

    ts = datetime.now().strftime("%Y%m%d_%H%M%S")
    output_dir = _resolve_output_dir(output_dir, mkdir)
    saved = []
    for i, img in enumerate(imgs):
        data = base64.b64decode(img["data"])
        ext = "jpg" if img.get("mimeType", "").endswith("jpeg") else "png"
        filename = _build_filename(output_name, ts, i, f".{ext}")
        path = Path(output_dir) / filename
        path.write_bytes(data)
        saved.append(str(path))
    return saved


def _sdk_generate(prompt: str, output_dir: str, aspect_ratio: str, resolution: str, input_image: str | None,
                  output_name: str | None, mkdir: bool, select: str) -> list[str]:
    if genai is None or types is None:
        print("Error: google-genai is not installed.")
        return []

    client_kwargs = {"api_key": API_KEY}
    if API_BASE_URL:
        client_kwargs["http_options"] = {"base_url": API_BASE_URL}
    client = genai.Client(**client_kwargs)

    if input_image:
        if not Path(input_image).exists():
            print(f"Error: Input image not found: {input_image}")
            return []
        with open(input_image, "rb") as f:
            image_bytes = f.read()
        mime_type, _ = guess_type(input_image)
        if mime_type is None:
            mime_type = "image/png"
        image_part = types.Part.from_bytes(data=image_bytes, mime_type=mime_type)
        contents = [prompt, image_part]
    else:
        contents = prompt

    try:
        response = client.models.generate_content(
            model=MODEL,
            contents=contents,
            config=types.GenerateContentConfig(
                image_config=types.ImageConfig(
                    aspectRatio=aspect_ratio,
                    imageSize=resolution,
                )
            ),
        )
    except Exception as exc:
        print(f"API Error: {exc}")
        return []

    saved = []
    ts = datetime.now().strftime("%Y%m%d_%H%M%S")
    output_dir = _resolve_output_dir(output_dir, mkdir)
    image_parts = []
    for part in response.parts:
        if part.text is not None:
            print(f"Response text: {part.text}")
        elif image := part.as_image():
            image_parts.append(image)

    if not image_parts:
        return []

    if select == "first":
        image_parts = image_parts[:1]
    elif select == "last":
        image_parts = image_parts[-1:]
    elif select == "max_res":
        image_parts = [max(image_parts, key=lambda x: len(x.image_bytes))]

    for i, image in enumerate(image_parts):
        filename = _build_filename(output_name, ts, i, ".png")
        path = Path(output_dir) / filename
        image.save(path)
        saved.append(str(path))
    return saved


def _http_generate(prompt: str, output_dir: str, aspect_ratio: str, resolution: str, input_image: str | None,
                   select: str, output_name: str | None, mkdir: bool) -> list[str]:
    if input_image and not Path(input_image).exists():
        print(f"Error: Input image not found: {input_image}")
        return []

    url = f"{API_BASE_URL.rstrip(&#39;/&#39;)}/v1beta/models/{MODEL}:generateContent"
    parts = [{"text": prompt}]
    if input_image:
        parts.append(_load_image_inline(input_image))

    body = {
        "contents": [{"parts": parts}],
        "generationConfig": {
            "responseModalities": ["TEXT", "IMAGE"],
            "imageConfig": {"aspectRatio": aspect_ratio, "imageSize": resolution},
        },
    }

    try:
        resp = _post_json(url, body)
    except Exception as exc:
        print(f"API Error: {exc}")
        return []

    if "candidates" not in resp:
        print(f"Unexpected response: {resp}")
        return []

    parts_out = resp["candidates"][0]["content"]["parts"]
    return _save_images(parts_out, output_dir, select, output_name, mkdir)


def main():
    parser = argparse.ArgumentParser(description="Generate images via SDK or HTTP")
    parser.add_argument("prompt", nargs="*", help="Image description prompt")
    parser.add_argument("--mode", default="sdk", choices=["sdk", "http"])
    parser.add_argument("--aspect-ratio", "-a", default="16:9", choices=VALID_ASPECT_RATIOS)
    parser.add_argument("--resolution", "-r", default="4K", choices=VALID_RESOLUTIONS)
    parser.add_argument("--output-dir", "-o", default=".")
    parser.add_argument("--output-name", default=None)
    parser.add_argument("--mkdir", action="store_true")
    parser.add_argument("--input-image", "-i", default=None)
    parser.add_argument("--select", default="all", choices=["all", "first", "last", "max_res"])

    args = parser.parse_args()
    if not args.prompt:
        parser.print_help()
        sys.exit(1)

    prompt = " ".join(args.prompt)

    if args.mode == "sdk":
        saved = _sdk_generate(
            prompt=prompt,
            output_dir=args.output_dir,
            aspect_ratio=args.aspect_ratio,
            resolution=args.resolution,
            input_image=args.input_image,
            output_name=args.output_name,
            mkdir=args.mkdir,
            select=args.select,
        )
    else:
        saved = _http_generate(
            prompt=prompt,
            output_dir=args.output_dir,
            aspect_ratio=args.aspect_ratio,
            resolution=args.resolution,
            input_image=args.input_image,
            select=args.select,
            output_name=args.output_name,
            mkdir=args.mkdir,
        )

    if saved:
        print(f"Generated {len(saved)} image(s):")
        for f in saved:
            print(f"  - {Path(f).resolve()}")
    else:
        print("No images were generated.")
        sys.exit(1)


if __name__ == "__main__":
    main()
基本用法：'><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"所有文章","item":"https://rendoumi.com/posts/"},{"@type":"ListItem","position":2,"name":"Claude code的skills编写","item":"https://rendoumi.com/posts/20251231-claude_skills/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Claude code的skills编写","name":"Claude code的skills编写","description":"最近天天都在学习claude code，Skills == 工具箱（技能库）\n我们可以把skills看成是一个个的小程序，这些程序有入口，有参数，有限制。\n那通过一篇md文件，来引导claude来智能的传参调用你的程序，这样技能箱就越来越丰富。\n一、我们首先准备这个可执行 python 脚本 这个是通过CLIProxyAPI的反代，把antigravity的gemini3模型给抽出来，然后生图\n看最下面，有一堆参数\n#!/usr/bin/env python3 # ============================================================ # Configuration - Edit these values before use # 配置项 - 使用前请修改以下值 # ============================================================ API_BASE_URL = \u0026#34;http://127.0.0.1:8317\u0026#34; # API server address / API 服务器地址 API_KEY = \u0026#34;key\u0026#34; # Your API key / 你的 API 密钥 MODEL = \u0026#34;gemini-3-pro-image-preview\u0026#34; # Model name / 模型名称 # ============================================================ import argparse import base64 import json import os import sys from datetime import datetime from pathlib import Path from urllib import request from mimetypes import guess_type try: from google import genai from google.genai import types except ImportError: genai = None types = None VALID_ASPECT_RATIOS = [\u0026#34;1:1\u0026#34;, \u0026#34;2:3\u0026#34;, \u0026#34;3:2\u0026#34;, \u0026#34;3:4\u0026#34;, \u0026#34;4:3\u0026#34;, \u0026#34;4:5\u0026#34;, \u0026#34;5:4\u0026#34;, \u0026#34;9:16\u0026#34;, \u0026#34;16:9\u0026#34;, \u0026#34;21:9\u0026#34;] VALID_RESOLUTIONS = [\u0026#34;1K\u0026#34;, \u0026#34;2K\u0026#34;, \u0026#34;4K\u0026#34;] def _resolve_output_dir(output_dir: str, mkdir: bool) -\u0026gt; str: if os.path.isdir(output_dir): return output_dir if mkdir: os.makedirs(output_dir, exist_ok=True) return output_dir print(f\u0026#34;Warning: Output directory not found: {output_dir}. Saving to current directory.\u0026#34;) return \u0026#34;.\u0026#34; def _build_filename(output_name: str | None, timestamp: str, index: int, default_ext: str) -\u0026gt; str: if output_name: root, ext = os.path.splitext(output_name) if not ext: ext = default_ext suffix = f\u0026#34;_{index}\u0026#34; if index \u0026gt; 0 else \u0026#34;\u0026#34; return f\u0026#34;{root}{suffix}{ext}\u0026#34; return f\u0026#34;generated_{timestamp}_{index}{default_ext}\u0026#34; def _load_image_inline(image_path: str) -\u0026gt; dict: mime_type, _ = guess_type(image_path) if mime_type is None: mime_type = \u0026#34;image/png\u0026#34; data = Path(image_path).read_bytes() return {\u0026#34;inlineData\u0026#34;: {\u0026#34;mimeType\u0026#34;: mime_type, \u0026#34;data\u0026#34;: base64.b64encode(data).decode(\u0026#34;ascii\u0026#34;)}} def _post_json(url: str, body: dict) -\u0026gt; dict: data = json.dumps(body).encode(\u0026#34;utf-8\u0026#34;) req = request.Request( url, data=data, headers={\u0026#34;Content-Type\u0026#34;: \u0026#34;application/json\u0026#34;, \u0026#34;x-goog-api-key\u0026#34;: API_KEY}, ) resp = request.urlopen(req).read() return json.loads(resp) def _save_images(parts, output_dir: str, select: str, output_name: str | None, mkdir: bool) -\u0026gt; list[str]: imgs = [p[\u0026#34;inlineData\u0026#34;] for p in parts if \u0026#34;inlineData\u0026#34; in p] if not imgs: return [] if select == \u0026#34;first\u0026#34;: imgs = imgs[:1] elif select == \u0026#34;last\u0026#34;: imgs = imgs[-1:] elif select == \u0026#34;max_res\u0026#34;: imgs = imgs[-1:] ts = datetime.now().strftime(\u0026#34;%Y%m%d_%H%M%S\u0026#34;) output_dir = _resolve_output_dir(output_dir, mkdir) saved = [] for i, img in enumerate(imgs): data = base64.b64decode(img[\u0026#34;data\u0026#34;]) ext = \u0026#34;jpg\u0026#34; if img.get(\u0026#34;mimeType\u0026#34;, \u0026#34;\u0026#34;).endswith(\u0026#34;jpeg\u0026#34;) else \u0026#34;png\u0026#34; filename = _build_filename(output_name, ts, i, f\u0026#34;.{ext}\u0026#34;) path = Path(output_dir) / filename path.write_bytes(data) saved.append(str(path)) return saved def _sdk_generate(prompt: str, output_dir: str, aspect_ratio: str, resolution: str, input_image: str | None, output_name: str | None, mkdir: bool, select: str) -\u0026gt; list[str]: if genai is None or types is None: print(\u0026#34;Error: google-genai is not installed.\u0026#34;) return [] client_kwargs = {\u0026#34;api_key\u0026#34;: API_KEY} if API_BASE_URL: client_kwargs[\u0026#34;http_options\u0026#34;] = {\u0026#34;base_url\u0026#34;: API_BASE_URL} client = genai.Client(**client_kwargs) if input_image: if not Path(input_image).exists(): print(f\u0026#34;Error: Input image not found: {input_image}\u0026#34;) return [] with open(input_image, \u0026#34;rb\u0026#34;) as f: image_bytes = f.read() mime_type, _ = guess_type(input_image) if mime_type is None: mime_type = \u0026#34;image/png\u0026#34; image_part = types.Part.from_bytes(data=image_bytes, mime_type=mime_type) contents = [prompt, image_part] else: contents = prompt try: response = client.models.generate_content( model=MODEL, contents=contents, config=types.GenerateContentConfig( image_config=types.ImageConfig( aspectRatio=aspect_ratio, imageSize=resolution, ) ), ) except Exception as exc: print(f\u0026#34;API Error: {exc}\u0026#34;) return [] saved = [] ts = datetime.now().strftime(\u0026#34;%Y%m%d_%H%M%S\u0026#34;) output_dir = _resolve_output_dir(output_dir, mkdir) image_parts = [] for part in response.parts: if part.text is not None: print(f\u0026#34;Response text: {part.text}\u0026#34;) elif image := part.as_image(): image_parts.append(image) if not image_parts: return [] if select == \u0026#34;first\u0026#34;: image_parts = image_parts[:1] elif select == \u0026#34;last\u0026#34;: image_parts = image_parts[-1:] elif select == \u0026#34;max_res\u0026#34;: image_parts = [max(image_parts, key=lambda x: len(x.image_bytes))] for i, image in enumerate(image_parts): filename = _build_filename(output_name, ts, i, \u0026#34;.png\u0026#34;) path = Path(output_dir) / filename image.save(path) saved.append(str(path)) return saved def _http_generate(prompt: str, output_dir: str, aspect_ratio: str, resolution: str, input_image: str | None, select: str, output_name: str | None, mkdir: bool) -\u0026gt; list[str]: if input_image and not Path(input_image).exists(): print(f\u0026#34;Error: Input image not found: {input_image}\u0026#34;) return [] url = f\u0026#34;{API_BASE_URL.rstrip(\u0026#39;/\u0026#39;)}/v1beta/models/{MODEL}:generateContent\u0026#34; parts = [{\u0026#34;text\u0026#34;: prompt}] if input_image: parts.append(_load_image_inline(input_image)) body = { \u0026#34;contents\u0026#34;: [{\u0026#34;parts\u0026#34;: parts}], \u0026#34;generationConfig\u0026#34;: { \u0026#34;responseModalities\u0026#34;: [\u0026#34;TEXT\u0026#34;, \u0026#34;IMAGE\u0026#34;], \u0026#34;imageConfig\u0026#34;: {\u0026#34;aspectRatio\u0026#34;: aspect_ratio, \u0026#34;imageSize\u0026#34;: resolution}, }, } try: resp = _post_json(url, body) except Exception as exc: print(f\u0026#34;API Error: {exc}\u0026#34;) return [] if \u0026#34;candidates\u0026#34; not in resp: print(f\u0026#34;Unexpected response: {resp}\u0026#34;) return [] parts_out = resp[\u0026#34;candidates\u0026#34;][0][\u0026#34;content\u0026#34;][\u0026#34;parts\u0026#34;] return _save_images(parts_out, output_dir, select, output_name, mkdir) def main(): parser = argparse.ArgumentParser(description=\u0026#34;Generate images via SDK or HTTP\u0026#34;) parser.add_argument(\u0026#34;prompt\u0026#34;, nargs=\u0026#34;*\u0026#34;, help=\u0026#34;Image description prompt\u0026#34;) parser.add_argument(\u0026#34;--mode\u0026#34;, default=\u0026#34;sdk\u0026#34;, choices=[\u0026#34;sdk\u0026#34;, \u0026#34;http\u0026#34;]) parser.add_argument(\u0026#34;--aspect-ratio\u0026#34;, \u0026#34;-a\u0026#34;, default=\u0026#34;16:9\u0026#34;, choices=VALID_ASPECT_RATIOS) parser.add_argument(\u0026#34;--resolution\u0026#34;, \u0026#34;-r\u0026#34;, default=\u0026#34;4K\u0026#34;, choices=VALID_RESOLUTIONS) parser.add_argument(\u0026#34;--output-dir\u0026#34;, \u0026#34;-o\u0026#34;, default=\u0026#34;.\u0026#34;) parser.add_argument(\u0026#34;--output-name\u0026#34;, default=None) parser.add_argument(\u0026#34;--mkdir\u0026#34;, action=\u0026#34;store_true\u0026#34;) parser.add_argument(\u0026#34;--input-image\u0026#34;, \u0026#34;-i\u0026#34;, default=None) parser.add_argument(\u0026#34;--select\u0026#34;, default=\u0026#34;all\u0026#34;, choices=[\u0026#34;all\u0026#34;, \u0026#34;first\u0026#34;, \u0026#34;last\u0026#34;, \u0026#34;max_res\u0026#34;]) args = parser.parse_args() if not args.prompt: parser.print_help() sys.exit(1) prompt = \u0026#34; \u0026#34;.join(args.prompt) if args.mode == \u0026#34;sdk\u0026#34;: saved = _sdk_generate( prompt=prompt, output_dir=args.output_dir, aspect_ratio=args.aspect_ratio, resolution=args.resolution, input_image=args.input_image, output_name=args.output_name, mkdir=args.mkdir, select=args.select, ) else: saved = _http_generate( prompt=prompt, output_dir=args.output_dir, aspect_ratio=args.aspect_ratio, resolution=args.resolution, input_image=args.input_image, select=args.select, output_name=args.output_name, mkdir=args.mkdir, ) if saved: print(f\u0026#34;Generated {len(saved)} image(s):\u0026#34;) for f in saved: print(f\u0026#34; - {Path(f).resolve()}\u0026#34;) else: print(\u0026#34;No images were generated.\u0026#34;) sys.exit(1) if __name__ == \u0026#34;__main__\u0026#34;: main() 基本用法：\n","keywords":[],"articleBody":"最近天天都在学习claude code，Skills == 工具箱（技能库）\n我们可以把skills看成是一个个的小程序，这些程序有入口，有参数，有限制。\n那通过一篇md文件，来引导claude来智能的传参调用你的程序，这样技能箱就越来越丰富。\n一、我们首先准备这个可执行 python 脚本 这个是通过CLIProxyAPI的反代，把antigravity的gemini3模型给抽出来，然后生图\n看最下面，有一堆参数\n#!/usr/bin/env python3 # ============================================================ # Configuration - Edit these values before use # 配置项 - 使用前请修改以下值 # ============================================================ API_BASE_URL = \"http://127.0.0.1:8317\" # API server address / API 服务器地址 API_KEY = \"key\" # Your API key / 你的 API 密钥 MODEL = \"gemini-3-pro-image-preview\" # Model name / 模型名称 # ============================================================ import argparse import base64 import json import os import sys from datetime import datetime from pathlib import Path from urllib import request from mimetypes import guess_type try: from google import genai from google.genai import types except ImportError: genai = None types = None VALID_ASPECT_RATIOS = [\"1:1\", \"2:3\", \"3:2\", \"3:4\", \"4:3\", \"4:5\", \"5:4\", \"9:16\", \"16:9\", \"21:9\"] VALID_RESOLUTIONS = [\"1K\", \"2K\", \"4K\"] def _resolve_output_dir(output_dir: str, mkdir: bool) -\u003e str: if os.path.isdir(output_dir): return output_dir if mkdir: os.makedirs(output_dir, exist_ok=True) return output_dir print(f\"Warning: Output directory not found: {output_dir}. Saving to current directory.\") return \".\" def _build_filename(output_name: str | None, timestamp: str, index: int, default_ext: str) -\u003e str: if output_name: root, ext = os.path.splitext(output_name) if not ext: ext = default_ext suffix = f\"_{index}\" if index \u003e 0 else \"\" return f\"{root}{suffix}{ext}\" return f\"generated_{timestamp}_{index}{default_ext}\" def _load_image_inline(image_path: str) -\u003e dict: mime_type, _ = guess_type(image_path) if mime_type is None: mime_type = \"image/png\" data = Path(image_path).read_bytes() return {\"inlineData\": {\"mimeType\": mime_type, \"data\": base64.b64encode(data).decode(\"ascii\")}} def _post_json(url: str, body: dict) -\u003e dict: data = json.dumps(body).encode(\"utf-8\") req = request.Request( url, data=data, headers={\"Content-Type\": \"application/json\", \"x-goog-api-key\": API_KEY}, ) resp = request.urlopen(req).read() return json.loads(resp) def _save_images(parts, output_dir: str, select: str, output_name: str | None, mkdir: bool) -\u003e list[str]: imgs = [p[\"inlineData\"] for p in parts if \"inlineData\" in p] if not imgs: return [] if select == \"first\": imgs = imgs[:1] elif select == \"last\": imgs = imgs[-1:] elif select == \"max_res\": imgs = imgs[-1:] ts = datetime.now().strftime(\"%Y%m%d_%H%M%S\") output_dir = _resolve_output_dir(output_dir, mkdir) saved = [] for i, img in enumerate(imgs): data = base64.b64decode(img[\"data\"]) ext = \"jpg\" if img.get(\"mimeType\", \"\").endswith(\"jpeg\") else \"png\" filename = _build_filename(output_name, ts, i, f\".{ext}\") path = Path(output_dir) / filename path.write_bytes(data) saved.append(str(path)) return saved def _sdk_generate(prompt: str, output_dir: str, aspect_ratio: str, resolution: str, input_image: str | None, output_name: str | None, mkdir: bool, select: str) -\u003e list[str]: if genai is None or types is None: print(\"Error: google-genai is not installed.\") return [] client_kwargs = {\"api_key\": API_KEY} if API_BASE_URL: client_kwargs[\"http_options\"] = {\"base_url\": API_BASE_URL} client = genai.Client(**client_kwargs) if input_image: if not Path(input_image).exists(): print(f\"Error: Input image not found: {input_image}\") return [] with open(input_image, \"rb\") as f: image_bytes = f.read() mime_type, _ = guess_type(input_image) if mime_type is None: mime_type = \"image/png\" image_part = types.Part.from_bytes(data=image_bytes, mime_type=mime_type) contents = [prompt, image_part] else: contents = prompt try: response = client.models.generate_content( model=MODEL, contents=contents, config=types.GenerateContentConfig( image_config=types.ImageConfig( aspectRatio=aspect_ratio, imageSize=resolution, ) ), ) except Exception as exc: print(f\"API Error: {exc}\") return [] saved = [] ts = datetime.now().strftime(\"%Y%m%d_%H%M%S\") output_dir = _resolve_output_dir(output_dir, mkdir) image_parts = [] for part in response.parts: if part.text is not None: print(f\"Response text: {part.text}\") elif image := part.as_image(): image_parts.append(image) if not image_parts: return [] if select == \"first\": image_parts = image_parts[:1] elif select == \"last\": image_parts = image_parts[-1:] elif select == \"max_res\": image_parts = [max(image_parts, key=lambda x: len(x.image_bytes))] for i, image in enumerate(image_parts): filename = _build_filename(output_name, ts, i, \".png\") path = Path(output_dir) / filename image.save(path) saved.append(str(path)) return saved def _http_generate(prompt: str, output_dir: str, aspect_ratio: str, resolution: str, input_image: str | None, select: str, output_name: str | None, mkdir: bool) -\u003e list[str]: if input_image and not Path(input_image).exists(): print(f\"Error: Input image not found: {input_image}\") return [] url = f\"{API_BASE_URL.rstrip('/')}/v1beta/models/{MODEL}:generateContent\" parts = [{\"text\": prompt}] if input_image: parts.append(_load_image_inline(input_image)) body = { \"contents\": [{\"parts\": parts}], \"generationConfig\": { \"responseModalities\": [\"TEXT\", \"IMAGE\"], \"imageConfig\": {\"aspectRatio\": aspect_ratio, \"imageSize\": resolution}, }, } try: resp = _post_json(url, body) except Exception as exc: print(f\"API Error: {exc}\") return [] if \"candidates\" not in resp: print(f\"Unexpected response: {resp}\") return [] parts_out = resp[\"candidates\"][0][\"content\"][\"parts\"] return _save_images(parts_out, output_dir, select, output_name, mkdir) def main(): parser = argparse.ArgumentParser(description=\"Generate images via SDK or HTTP\") parser.add_argument(\"prompt\", nargs=\"*\", help=\"Image description prompt\") parser.add_argument(\"--mode\", default=\"sdk\", choices=[\"sdk\", \"http\"]) parser.add_argument(\"--aspect-ratio\", \"-a\", default=\"16:9\", choices=VALID_ASPECT_RATIOS) parser.add_argument(\"--resolution\", \"-r\", default=\"4K\", choices=VALID_RESOLUTIONS) parser.add_argument(\"--output-dir\", \"-o\", default=\".\") parser.add_argument(\"--output-name\", default=None) parser.add_argument(\"--mkdir\", action=\"store_true\") parser.add_argument(\"--input-image\", \"-i\", default=None) parser.add_argument(\"--select\", default=\"all\", choices=[\"all\", \"first\", \"last\", \"max_res\"]) args = parser.parse_args() if not args.prompt: parser.print_help() sys.exit(1) prompt = \" \".join(args.prompt) if args.mode == \"sdk\": saved = _sdk_generate( prompt=prompt, output_dir=args.output_dir, aspect_ratio=args.aspect_ratio, resolution=args.resolution, input_image=args.input_image, output_name=args.output_name, mkdir=args.mkdir, select=args.select, ) else: saved = _http_generate( prompt=prompt, output_dir=args.output_dir, aspect_ratio=args.aspect_ratio, resolution=args.resolution, input_image=args.input_image, select=args.select, output_name=args.output_name, mkdir=args.mkdir, ) if saved: print(f\"Generated {len(saved)} image(s):\") for f in saved: print(f\" - {Path(f).resolve()}\") else: print(\"No images were generated.\") sys.exit(1) if __name__ == \"__main__\": main() 基本用法：\n# Python 3.10+ # google-genai 包（SDK 模式需要） # SDK 模式（默认） python ~/.claude/skills/image-generator-hybrid/scripts/generate.py \"山间日落\" -r 4K -a 16:9 # HTTP 模式 python ~/.claude/skills/image-generator-hybrid/scripts/generate.py \"山间日落\" --mode http -r 4K 使用示例：\n# 生成 4K 竖版图片 python ~/.claude/skills/image-generator-hybrid/scripts/generate.py \"人像照片\" -r 4K -a 9:16 # 以图生图 python ~/.claude/skills/image-generator-hybrid/scripts/generate.py \"转换为赛博朋克风格\" -i input.jpg # 仅保存最高分辨率 python ~/.claude/skills/image-generator-hybrid/scripts/generate.py \"风景\" --select max_res # 自定义输出位置 python ~/.claude/skills/image-generator-hybrid/scripts/generate.py \"猫咪\" -o ./images --mkdir --output-name cat 二、准备claude/skills目录结构 在 ~/.claude/新建skills/gen-image目录，在gen-image下建scripts目录，把python文件放进去\n三、准备SKILL.md文件 --- name: gen-image description: 同时支持 SDK 与 HTTP 两种方式生成图片，可按需切换保存策略。 allowed-tools: Bash(python:*) --- # Image Generator (Hybrid) Skill 一个脚本同时支持 SDK 与 HTTP 直连两种模式。 ## 配置 - **API 端点**: `http://127.0.0.1:8317/v1beta/models/gemini-3-pro-image-preview:generateContent` - **模型**: `gemini-3-pro-image-preview` - **API Key**: `key` 可通过环境变量覆盖默认配置： - `IMAGE_API_KEY`: API 密钥 - `IMAGE_MODEL`: 使用的模型名称 - `IMAGE_API_BASE_URL`: API 基础地址 ## 参数 - `--mode`: `sdk|http`（默认 `sdk`） - `-r/--resolution`: `1K|2K|4K` - `-a/--aspect-ratio`: `1:1|2:3|3:2|3:4|4:3|4:5|5:4|9:16|16:9|21:9` - `-i/--input-image`: 以图生图输入图片路径 - `--select`: `all|first|last|max_res` - `max_res` 会选择返回中“最大体积”的那张（通常是 4K） - `-o/--output-dir`: 输出目录（默认当前目录） - `--output-name`: 指定文件名（可选；若返回多张，自动追加 `_1/_2`） - `--mkdir`: 当输出目录不存在时创建（默认 false）；否则回退到当前目录 ## 使用 ```bash # SDK 模式（默认） python ~/.claude/skills/gen-image/scripts/generate.py \"描述\" -r 4K -a 16:9 # HTTP 模式（保存全部返回图片） python ~/.claude/skills/gen-image/scripts/generate.py \"描述\" --mode http -r 4K -a 1:1 --select all # 仅保存最大尺寸 python ~/.claude/skills/gen-image/scripts/generate.py \"描述\" --mode http -r 4K -a 1:1 --select max_res ``` 看明白了吧，这个markdown 描述了这个技能的情况，配置、参数、使用\n最厉害的是claude会根据这个markdown文件来自动调用这个脚本，自己匹配合适的参数，这才是最厉害的地方\n那每个SKILL都是一个md文件，给个模板：\n# 技能名称 简单说明这个技能是干嘛用的，一般在什么情况下会用到。 ## 什么时候用 - 场景1：比如要上线新版本时 - 场景2：比如遇到某个特定错误时 ## 具体步骤 1. 第一步要做什么（附上具体的命令） 2. 第二步... 3. 依次往下 ## 怎么确认成功了 做完之后，通过哪些方法可以验证操作是成功的。 ## 可能遇到的问题 - 问题1：如果遇到...，可以试试... - 问题2：有时候会...，这时候应该... 四、配置Claude 在CLAUDE.md中添加\n## 生图 生成图片 使用技能 ~/.claude/skills/gen-image 然后就可以在claude里面使用了\n生图，4K，1:1，随机内容，仅保留最大分辨率，输出在当前目录，文件名：001.png 五、发散思维 这个是用的gemini的模型，那改改程序，用前面文章提供的接口：\n魔搭、模力方舟、豆包免费文生图 就可以随便生图了\n","wordCount":"961","inLanguage":"zh","datePublished":"2025-12-31T09:40:01+08:00","dateModified":"2025-12-31T09:40:01+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://rendoumi.com/posts/20251231-claude_skills/"},"publisher":{"@type":"Organization","name":"八戒的技术博客","logo":{"@type":"ImageObject","url":"https://rendoumi.com/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://rendoumi.com/ accesskey=h title="八戒的技术博客 (Alt + H)">八戒的技术博客</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://rendoumi.com/ title=首页><span>首页</span></a></li><li><a href=https://rendoumi.com/posts/ title=文章><span>文章</span></a></li><li><a href=https://rendoumi.com/archives/ title=归档><span>归档</span></a></li><li><a href=https://blog.rendoumi.com title=生活><span>生活</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://rendoumi.com/search/ title=搜索><span>搜索</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Claude code的skills编写
<span class=entry-hint title=Draft><svg height="35" viewBox="0 -960 960 960" fill="currentcolor"><path d="M160-410v-60h3e2v60H160zm0-165v-60h470v60H160zm0-165v-60h470v60H160zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22-4.5 22.5T862.09-380L643-160H520zm3e2-263-37-37 37 37zM580-220h38l121-122-18-19-19-18-122 121v38zm141-141-19-18 37 37-18-19z"/></svg></span></h1><div class=post-meta><span title='2025-12-31 09:40:01 +0800 CST'>2025年12月31日</span></div></header><div class=post-content><p>最近天天都在学习claude code，Skills == 工具箱（技能库）</p><p>我们可以把skills看成是一个个的小程序，这些程序有入口，有参数，有限制。</p><p>那通过一篇md文件，来引导claude来智能的传参调用你的程序，这样技能箱就越来越丰富。</p><h4 id=一我们首先准备这个可执行-python-脚本>一、我们首先准备这个可执行 python 脚本<a hidden class=anchor aria-hidden=true href=#一我们首先准备这个可执行-python-脚本>#</a></h4><p>这个是通过CLIProxyAPI的反代，把antigravity的gemini3模型给抽出来，然后生图</p><p>看最下面，有一堆参数</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#!/usr/bin/env python3
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=c1># ============================================================</span>
</span></span><span class=line><span class=cl><span class=c1># Configuration - Edit these values before use</span>
</span></span><span class=line><span class=cl><span class=c1># 配置项 - 使用前请修改以下值</span>
</span></span><span class=line><span class=cl><span class=c1># ============================================================</span>
</span></span><span class=line><span class=cl><span class=nv>API_BASE_URL</span> <span class=o>=</span> <span class=s2>&#34;http://127.0.0.1:8317&#34;</span>  <span class=c1># API server address / API 服务器地址</span>
</span></span><span class=line><span class=cl><span class=nv>API_KEY</span> <span class=o>=</span> <span class=s2>&#34;key&#34;</span>                          <span class=c1># Your API key / 你的 API 密钥</span>
</span></span><span class=line><span class=cl><span class=nv>MODEL</span> <span class=o>=</span> <span class=s2>&#34;gemini-3-pro-image-preview&#34;</span>     <span class=c1># Model name / 模型名称</span>
</span></span><span class=line><span class=cl><span class=c1># ============================================================</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>import argparse
</span></span><span class=line><span class=cl>import base64
</span></span><span class=line><span class=cl>import json
</span></span><span class=line><span class=cl>import os
</span></span><span class=line><span class=cl>import sys
</span></span><span class=line><span class=cl>from datetime import datetime
</span></span><span class=line><span class=cl>from pathlib import Path
</span></span><span class=line><span class=cl>from urllib import request
</span></span><span class=line><span class=cl>from mimetypes import guess_type
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>try:
</span></span><span class=line><span class=cl>    from google import genai
</span></span><span class=line><span class=cl>    from google.genai import types
</span></span><span class=line><span class=cl>except ImportError:
</span></span><span class=line><span class=cl>    <span class=nv>genai</span> <span class=o>=</span> None
</span></span><span class=line><span class=cl>    <span class=nv>types</span> <span class=o>=</span> None
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>VALID_ASPECT_RATIOS</span> <span class=o>=</span> <span class=o>[</span><span class=s2>&#34;1:1&#34;</span>, <span class=s2>&#34;2:3&#34;</span>, <span class=s2>&#34;3:2&#34;</span>, <span class=s2>&#34;3:4&#34;</span>, <span class=s2>&#34;4:3&#34;</span>, <span class=s2>&#34;4:5&#34;</span>, <span class=s2>&#34;5:4&#34;</span>, <span class=s2>&#34;9:16&#34;</span>, <span class=s2>&#34;16:9&#34;</span>, <span class=s2>&#34;21:9&#34;</span><span class=o>]</span>
</span></span><span class=line><span class=cl><span class=nv>VALID_RESOLUTIONS</span> <span class=o>=</span> <span class=o>[</span><span class=s2>&#34;1K&#34;</span>, <span class=s2>&#34;2K&#34;</span>, <span class=s2>&#34;4K&#34;</span><span class=o>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>def _resolve_output_dir<span class=o>(</span>output_dir: str, mkdir: bool<span class=o>)</span> -&gt; str:
</span></span><span class=line><span class=cl>    <span class=k>if</span> os.path.isdir<span class=o>(</span>output_dir<span class=o>)</span>:
</span></span><span class=line><span class=cl>        <span class=k>return</span> output_dir
</span></span><span class=line><span class=cl>    <span class=k>if</span> mkdir:
</span></span><span class=line><span class=cl>        os.makedirs<span class=o>(</span>output_dir, <span class=nv>exist_ok</span><span class=o>=</span>True<span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> output_dir
</span></span><span class=line><span class=cl>    print<span class=o>(</span>f<span class=s2>&#34;Warning: Output directory not found: {output_dir}. Saving to current directory.&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s2>&#34;.&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>def _build_filename<span class=o>(</span>output_name: str <span class=p>|</span> None, timestamp: str, index: int, default_ext: str<span class=o>)</span> -&gt; str:
</span></span><span class=line><span class=cl>    <span class=k>if</span> output_name:
</span></span><span class=line><span class=cl>        root, <span class=nv>ext</span> <span class=o>=</span> os.path.splitext<span class=o>(</span>output_name<span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> not ext:
</span></span><span class=line><span class=cl>            <span class=nv>ext</span> <span class=o>=</span> default_ext
</span></span><span class=line><span class=cl>        <span class=nv>suffix</span> <span class=o>=</span> f<span class=s2>&#34;_{index}&#34;</span> <span class=k>if</span> index &gt; <span class=m>0</span> <span class=k>else</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> f<span class=s2>&#34;{root}{suffix}{ext}&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> f<span class=s2>&#34;generated_{timestamp}_{index}{default_ext}&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>def _load_image_inline<span class=o>(</span>image_path: str<span class=o>)</span> -&gt; dict:
</span></span><span class=line><span class=cl>    mime_type, <span class=nv>_</span> <span class=o>=</span> guess_type<span class=o>(</span>image_path<span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> mime_type is None:
</span></span><span class=line><span class=cl>        <span class=nv>mime_type</span> <span class=o>=</span> <span class=s2>&#34;image/png&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nv>data</span> <span class=o>=</span> Path<span class=o>(</span>image_path<span class=o>)</span>.read_bytes<span class=o>()</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=o>{</span><span class=s2>&#34;inlineData&#34;</span>: <span class=o>{</span><span class=s2>&#34;mimeType&#34;</span>: mime_type, <span class=s2>&#34;data&#34;</span>: base64.b64encode<span class=o>(</span>data<span class=o>)</span>.decode<span class=o>(</span><span class=s2>&#34;ascii&#34;</span><span class=o>)}}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>def _post_json<span class=o>(</span>url: str, body: dict<span class=o>)</span> -&gt; dict:
</span></span><span class=line><span class=cl>    <span class=nv>data</span> <span class=o>=</span> json.dumps<span class=o>(</span>body<span class=o>)</span>.encode<span class=o>(</span><span class=s2>&#34;utf-8&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=nv>req</span> <span class=o>=</span> request.Request<span class=o>(</span>
</span></span><span class=line><span class=cl>        url,
</span></span><span class=line><span class=cl>        <span class=nv>data</span><span class=o>=</span>data,
</span></span><span class=line><span class=cl>        <span class=nv>headers</span><span class=o>={</span><span class=s2>&#34;Content-Type&#34;</span>: <span class=s2>&#34;application/json&#34;</span>, <span class=s2>&#34;x-goog-api-key&#34;</span>: API_KEY<span class=o>}</span>,
</span></span><span class=line><span class=cl>    <span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=nv>resp</span> <span class=o>=</span> request.urlopen<span class=o>(</span>req<span class=o>)</span>.read<span class=o>()</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> json.loads<span class=o>(</span>resp<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>def _save_images<span class=o>(</span>parts, output_dir: str, <span class=k>select</span>: str, output_name: str <span class=p>|</span> None, mkdir: bool<span class=o>)</span> -&gt; list<span class=o>[</span>str<span class=o>]</span>:
</span></span><span class=line><span class=cl>    <span class=nv>imgs</span> <span class=o>=</span> <span class=o>[</span>p<span class=o>[</span><span class=s2>&#34;inlineData&#34;</span><span class=o>]</span> <span class=k>for</span> p in parts <span class=k>if</span> <span class=s2>&#34;inlineData&#34;</span> in p<span class=o>]</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> not imgs:
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=o>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=k>select</span> <span class=o>==</span> <span class=s2>&#34;first&#34;</span>:
</span></span><span class=line><span class=cl>        <span class=nv>imgs</span> <span class=o>=</span> imgs<span class=o>[</span>:1<span class=o>]</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=k>select</span> <span class=o>==</span> <span class=s2>&#34;last&#34;</span>:
</span></span><span class=line><span class=cl>        <span class=nv>imgs</span> <span class=o>=</span> imgs<span class=o>[</span>-1:<span class=o>]</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=k>select</span> <span class=o>==</span> <span class=s2>&#34;max_res&#34;</span>:
</span></span><span class=line><span class=cl>        <span class=nv>imgs</span> <span class=o>=</span> imgs<span class=o>[</span>-1:<span class=o>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nv>ts</span> <span class=o>=</span> datetime.now<span class=o>()</span>.strftime<span class=o>(</span><span class=s2>&#34;%Y%m%d_%H%M%S&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=nv>output_dir</span> <span class=o>=</span> _resolve_output_dir<span class=o>(</span>output_dir, mkdir<span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=nv>saved</span> <span class=o>=</span> <span class=o>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> i, img in enumerate<span class=o>(</span>imgs<span class=o>)</span>:
</span></span><span class=line><span class=cl>        <span class=nv>data</span> <span class=o>=</span> base64.b64decode<span class=o>(</span>img<span class=o>[</span><span class=s2>&#34;data&#34;</span><span class=o>])</span>
</span></span><span class=line><span class=cl>        <span class=nv>ext</span> <span class=o>=</span> <span class=s2>&#34;jpg&#34;</span> <span class=k>if</span> img.get<span class=o>(</span><span class=s2>&#34;mimeType&#34;</span>, <span class=s2>&#34;&#34;</span><span class=o>)</span>.endswith<span class=o>(</span><span class=s2>&#34;jpeg&#34;</span><span class=o>)</span> <span class=k>else</span> <span class=s2>&#34;png&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nv>filename</span> <span class=o>=</span> _build_filename<span class=o>(</span>output_name, ts, i, f<span class=s2>&#34;.{ext}&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=nv>path</span> <span class=o>=</span> Path<span class=o>(</span>output_dir<span class=o>)</span> / filename
</span></span><span class=line><span class=cl>        path.write_bytes<span class=o>(</span>data<span class=o>)</span>
</span></span><span class=line><span class=cl>        saved.append<span class=o>(</span>str<span class=o>(</span>path<span class=o>))</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> saved
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>def _sdk_generate<span class=o>(</span>prompt: str, output_dir: str, aspect_ratio: str, resolution: str, input_image: str <span class=p>|</span> None,
</span></span><span class=line><span class=cl>                  output_name: str <span class=p>|</span> None, mkdir: bool, <span class=k>select</span>: str<span class=o>)</span> -&gt; list<span class=o>[</span>str<span class=o>]</span>:
</span></span><span class=line><span class=cl>    <span class=k>if</span> genai is None or types is None:
</span></span><span class=line><span class=cl>        print<span class=o>(</span><span class=s2>&#34;Error: google-genai is not installed.&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=o>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nv>client_kwargs</span> <span class=o>=</span> <span class=o>{</span><span class=s2>&#34;api_key&#34;</span>: API_KEY<span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> API_BASE_URL:
</span></span><span class=line><span class=cl>        client_kwargs<span class=o>[</span><span class=s2>&#34;http_options&#34;</span><span class=o>]</span> <span class=o>=</span> <span class=o>{</span><span class=s2>&#34;base_url&#34;</span>: API_BASE_URL<span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=nv>client</span> <span class=o>=</span> genai.Client<span class=o>(</span>**client_kwargs<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> input_image:
</span></span><span class=line><span class=cl>        <span class=k>if</span> not Path<span class=o>(</span>input_image<span class=o>)</span>.exists<span class=o>()</span>:
</span></span><span class=line><span class=cl>            print<span class=o>(</span>f<span class=s2>&#34;Error: Input image not found: {input_image}&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=o>[]</span>
</span></span><span class=line><span class=cl>        with open<span class=o>(</span>input_image, <span class=s2>&#34;rb&#34;</span><span class=o>)</span> as f:
</span></span><span class=line><span class=cl>            <span class=nv>image_bytes</span> <span class=o>=</span> f.read<span class=o>()</span>
</span></span><span class=line><span class=cl>        mime_type, <span class=nv>_</span> <span class=o>=</span> guess_type<span class=o>(</span>input_image<span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> mime_type is None:
</span></span><span class=line><span class=cl>            <span class=nv>mime_type</span> <span class=o>=</span> <span class=s2>&#34;image/png&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nv>image_part</span> <span class=o>=</span> types.Part.from_bytes<span class=o>(</span><span class=nv>data</span><span class=o>=</span>image_bytes, <span class=nv>mime_type</span><span class=o>=</span>mime_type<span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=nv>contents</span> <span class=o>=</span> <span class=o>[</span>prompt, image_part<span class=o>]</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span>:
</span></span><span class=line><span class=cl>        <span class=nv>contents</span> <span class=o>=</span> prompt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    try:
</span></span><span class=line><span class=cl>        <span class=nv>response</span> <span class=o>=</span> client.models.generate_content<span class=o>(</span>
</span></span><span class=line><span class=cl>            <span class=nv>model</span><span class=o>=</span>MODEL,
</span></span><span class=line><span class=cl>            <span class=nv>contents</span><span class=o>=</span>contents,
</span></span><span class=line><span class=cl>            <span class=nv>config</span><span class=o>=</span>types.GenerateContentConfig<span class=o>(</span>
</span></span><span class=line><span class=cl>                <span class=nv>image_config</span><span class=o>=</span>types.ImageConfig<span class=o>(</span>
</span></span><span class=line><span class=cl>                    <span class=nv>aspectRatio</span><span class=o>=</span>aspect_ratio,
</span></span><span class=line><span class=cl>                    <span class=nv>imageSize</span><span class=o>=</span>resolution,
</span></span><span class=line><span class=cl>                <span class=o>)</span>
</span></span><span class=line><span class=cl>            <span class=o>)</span>,
</span></span><span class=line><span class=cl>        <span class=o>)</span>
</span></span><span class=line><span class=cl>    except Exception as exc:
</span></span><span class=line><span class=cl>        print<span class=o>(</span>f<span class=s2>&#34;API Error: {exc}&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=o>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nv>saved</span> <span class=o>=</span> <span class=o>[]</span>
</span></span><span class=line><span class=cl>    <span class=nv>ts</span> <span class=o>=</span> datetime.now<span class=o>()</span>.strftime<span class=o>(</span><span class=s2>&#34;%Y%m%d_%H%M%S&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=nv>output_dir</span> <span class=o>=</span> _resolve_output_dir<span class=o>(</span>output_dir, mkdir<span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=nv>image_parts</span> <span class=o>=</span> <span class=o>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> part in response.parts:
</span></span><span class=line><span class=cl>        <span class=k>if</span> part.text is not None:
</span></span><span class=line><span class=cl>            print<span class=o>(</span>f<span class=s2>&#34;Response text: {part.text}&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> image :<span class=o>=</span> part.as_image<span class=o>()</span>:
</span></span><span class=line><span class=cl>            image_parts.append<span class=o>(</span>image<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> not image_parts:
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=o>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=k>select</span> <span class=o>==</span> <span class=s2>&#34;first&#34;</span>:
</span></span><span class=line><span class=cl>        <span class=nv>image_parts</span> <span class=o>=</span> image_parts<span class=o>[</span>:1<span class=o>]</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=k>select</span> <span class=o>==</span> <span class=s2>&#34;last&#34;</span>:
</span></span><span class=line><span class=cl>        <span class=nv>image_parts</span> <span class=o>=</span> image_parts<span class=o>[</span>-1:<span class=o>]</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=k>select</span> <span class=o>==</span> <span class=s2>&#34;max_res&#34;</span>:
</span></span><span class=line><span class=cl>        <span class=nv>image_parts</span> <span class=o>=</span> <span class=o>[</span>max<span class=o>(</span>image_parts, <span class=nv>key</span><span class=o>=</span>lambda x: len<span class=o>(</span>x.image_bytes<span class=o>))]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> i, image in enumerate<span class=o>(</span>image_parts<span class=o>)</span>:
</span></span><span class=line><span class=cl>        <span class=nv>filename</span> <span class=o>=</span> _build_filename<span class=o>(</span>output_name, ts, i, <span class=s2>&#34;.png&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=nv>path</span> <span class=o>=</span> Path<span class=o>(</span>output_dir<span class=o>)</span> / filename
</span></span><span class=line><span class=cl>        image.save<span class=o>(</span>path<span class=o>)</span>
</span></span><span class=line><span class=cl>        saved.append<span class=o>(</span>str<span class=o>(</span>path<span class=o>))</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> saved
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>def _http_generate<span class=o>(</span>prompt: str, output_dir: str, aspect_ratio: str, resolution: str, input_image: str <span class=p>|</span> None,
</span></span><span class=line><span class=cl>                   <span class=k>select</span>: str, output_name: str <span class=p>|</span> None, mkdir: bool<span class=o>)</span> -&gt; list<span class=o>[</span>str<span class=o>]</span>:
</span></span><span class=line><span class=cl>    <span class=k>if</span> input_image and not Path<span class=o>(</span>input_image<span class=o>)</span>.exists<span class=o>()</span>:
</span></span><span class=line><span class=cl>        print<span class=o>(</span>f<span class=s2>&#34;Error: Input image not found: {input_image}&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=o>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nv>url</span> <span class=o>=</span> f<span class=s2>&#34;{API_BASE_URL.rstrip(&#39;/&#39;)}/v1beta/models/{MODEL}:generateContent&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nv>parts</span> <span class=o>=</span> <span class=o>[{</span><span class=s2>&#34;text&#34;</span>: prompt<span class=o>}]</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> input_image:
</span></span><span class=line><span class=cl>        parts.append<span class=o>(</span>_load_image_inline<span class=o>(</span>input_image<span class=o>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nv>body</span> <span class=o>=</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;contents&#34;</span>: <span class=o>[{</span><span class=s2>&#34;parts&#34;</span>: parts<span class=o>}]</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;generationConfig&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;responseModalities&#34;</span>: <span class=o>[</span><span class=s2>&#34;TEXT&#34;</span>, <span class=s2>&#34;IMAGE&#34;</span><span class=o>]</span>,
</span></span><span class=line><span class=cl>            <span class=s2>&#34;imageConfig&#34;</span>: <span class=o>{</span><span class=s2>&#34;aspectRatio&#34;</span>: aspect_ratio, <span class=s2>&#34;imageSize&#34;</span>: resolution<span class=o>}</span>,
</span></span><span class=line><span class=cl>        <span class=o>}</span>,
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    try:
</span></span><span class=line><span class=cl>        <span class=nv>resp</span> <span class=o>=</span> _post_json<span class=o>(</span>url, body<span class=o>)</span>
</span></span><span class=line><span class=cl>    except Exception as exc:
</span></span><span class=line><span class=cl>        print<span class=o>(</span>f<span class=s2>&#34;API Error: {exc}&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=o>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=s2>&#34;candidates&#34;</span> not in resp:
</span></span><span class=line><span class=cl>        print<span class=o>(</span>f<span class=s2>&#34;Unexpected response: {resp}&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=o>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nv>parts_out</span> <span class=o>=</span> resp<span class=o>[</span><span class=s2>&#34;candidates&#34;</span><span class=o>][</span>0<span class=o>][</span><span class=s2>&#34;content&#34;</span><span class=o>][</span><span class=s2>&#34;parts&#34;</span><span class=o>]</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> _save_images<span class=o>(</span>parts_out, output_dir, <span class=k>select</span>, output_name, mkdir<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>def main<span class=o>()</span>:
</span></span><span class=line><span class=cl>    <span class=nv>parser</span> <span class=o>=</span> argparse.ArgumentParser<span class=o>(</span><span class=nv>description</span><span class=o>=</span><span class=s2>&#34;Generate images via SDK or HTTP&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    parser.add_argument<span class=o>(</span><span class=s2>&#34;prompt&#34;</span>, <span class=nv>nargs</span><span class=o>=</span><span class=s2>&#34;*&#34;</span>, <span class=nv>help</span><span class=o>=</span><span class=s2>&#34;Image description prompt&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    parser.add_argument<span class=o>(</span><span class=s2>&#34;--mode&#34;</span>, <span class=nv>default</span><span class=o>=</span><span class=s2>&#34;sdk&#34;</span>, <span class=nv>choices</span><span class=o>=[</span><span class=s2>&#34;sdk&#34;</span>, <span class=s2>&#34;http&#34;</span><span class=o>])</span>
</span></span><span class=line><span class=cl>    parser.add_argument<span class=o>(</span><span class=s2>&#34;--aspect-ratio&#34;</span>, <span class=s2>&#34;-a&#34;</span>, <span class=nv>default</span><span class=o>=</span><span class=s2>&#34;16:9&#34;</span>, <span class=nv>choices</span><span class=o>=</span>VALID_ASPECT_RATIOS<span class=o>)</span>
</span></span><span class=line><span class=cl>    parser.add_argument<span class=o>(</span><span class=s2>&#34;--resolution&#34;</span>, <span class=s2>&#34;-r&#34;</span>, <span class=nv>default</span><span class=o>=</span><span class=s2>&#34;4K&#34;</span>, <span class=nv>choices</span><span class=o>=</span>VALID_RESOLUTIONS<span class=o>)</span>
</span></span><span class=line><span class=cl>    parser.add_argument<span class=o>(</span><span class=s2>&#34;--output-dir&#34;</span>, <span class=s2>&#34;-o&#34;</span>, <span class=nv>default</span><span class=o>=</span><span class=s2>&#34;.&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    parser.add_argument<span class=o>(</span><span class=s2>&#34;--output-name&#34;</span>, <span class=nv>default</span><span class=o>=</span>None<span class=o>)</span>
</span></span><span class=line><span class=cl>    parser.add_argument<span class=o>(</span><span class=s2>&#34;--mkdir&#34;</span>, <span class=nv>action</span><span class=o>=</span><span class=s2>&#34;store_true&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    parser.add_argument<span class=o>(</span><span class=s2>&#34;--input-image&#34;</span>, <span class=s2>&#34;-i&#34;</span>, <span class=nv>default</span><span class=o>=</span>None<span class=o>)</span>
</span></span><span class=line><span class=cl>    parser.add_argument<span class=o>(</span><span class=s2>&#34;--select&#34;</span>, <span class=nv>default</span><span class=o>=</span><span class=s2>&#34;all&#34;</span>, <span class=nv>choices</span><span class=o>=[</span><span class=s2>&#34;all&#34;</span>, <span class=s2>&#34;first&#34;</span>, <span class=s2>&#34;last&#34;</span>, <span class=s2>&#34;max_res&#34;</span><span class=o>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nv>args</span> <span class=o>=</span> parser.parse_args<span class=o>()</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> not args.prompt:
</span></span><span class=line><span class=cl>        parser.print_help<span class=o>()</span>
</span></span><span class=line><span class=cl>        sys.exit<span class=o>(</span>1<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nv>prompt</span> <span class=o>=</span> <span class=s2>&#34; &#34;</span>.join<span class=o>(</span>args.prompt<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> args.mode <span class=o>==</span> <span class=s2>&#34;sdk&#34;</span>:
</span></span><span class=line><span class=cl>        <span class=nv>saved</span> <span class=o>=</span> _sdk_generate<span class=o>(</span>
</span></span><span class=line><span class=cl>            <span class=nv>prompt</span><span class=o>=</span>prompt,
</span></span><span class=line><span class=cl>            <span class=nv>output_dir</span><span class=o>=</span>args.output_dir,
</span></span><span class=line><span class=cl>            <span class=nv>aspect_ratio</span><span class=o>=</span>args.aspect_ratio,
</span></span><span class=line><span class=cl>            <span class=nv>resolution</span><span class=o>=</span>args.resolution,
</span></span><span class=line><span class=cl>            <span class=nv>input_image</span><span class=o>=</span>args.input_image,
</span></span><span class=line><span class=cl>            <span class=nv>output_name</span><span class=o>=</span>args.output_name,
</span></span><span class=line><span class=cl>            <span class=nv>mkdir</span><span class=o>=</span>args.mkdir,
</span></span><span class=line><span class=cl>            <span class=k>select</span><span class=o>=</span>args.select,
</span></span><span class=line><span class=cl>        <span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span>:
</span></span><span class=line><span class=cl>        <span class=nv>saved</span> <span class=o>=</span> _http_generate<span class=o>(</span>
</span></span><span class=line><span class=cl>            <span class=nv>prompt</span><span class=o>=</span>prompt,
</span></span><span class=line><span class=cl>            <span class=nv>output_dir</span><span class=o>=</span>args.output_dir,
</span></span><span class=line><span class=cl>            <span class=nv>aspect_ratio</span><span class=o>=</span>args.aspect_ratio,
</span></span><span class=line><span class=cl>            <span class=nv>resolution</span><span class=o>=</span>args.resolution,
</span></span><span class=line><span class=cl>            <span class=nv>input_image</span><span class=o>=</span>args.input_image,
</span></span><span class=line><span class=cl>            <span class=k>select</span><span class=o>=</span>args.select,
</span></span><span class=line><span class=cl>            <span class=nv>output_name</span><span class=o>=</span>args.output_name,
</span></span><span class=line><span class=cl>            <span class=nv>mkdir</span><span class=o>=</span>args.mkdir,
</span></span><span class=line><span class=cl>        <span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> saved:
</span></span><span class=line><span class=cl>        print<span class=o>(</span>f<span class=s2>&#34;Generated {len(saved)} image(s):&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> f in saved:
</span></span><span class=line><span class=cl>            print<span class=o>(</span>f<span class=s2>&#34;  - {Path(f).resolve()}&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span>:
</span></span><span class=line><span class=cl>        print<span class=o>(</span><span class=s2>&#34;No images were generated.&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>        sys.exit<span class=o>(</span>1<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=nv>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span>:
</span></span><span class=line><span class=cl>    main<span class=o>()</span>
</span></span></code></pre></div><p>基本用法：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Python 3.10+</span>
</span></span><span class=line><span class=cl><span class=c1># google-genai 包（SDK 模式需要）</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># SDK 模式（默认）</span>
</span></span><span class=line><span class=cl>python ~/.claude/skills/image-generator-hybrid/scripts/generate.py <span class=s2>&#34;山间日落&#34;</span> -r 4K -a 16:9
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># HTTP 模式</span>
</span></span><span class=line><span class=cl>python ~/.claude/skills/image-generator-hybrid/scripts/generate.py <span class=s2>&#34;山间日落&#34;</span> --mode http -r 4K
</span></span></code></pre></div><p><img alt=image-20251231132255154 loading=lazy src=/posts/20251231-claude_skills/image-20251231132255154.png></p><p>使用示例：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 生成 4K 竖版图片</span>
</span></span><span class=line><span class=cl>python ~/.claude/skills/image-generator-hybrid/scripts/generate.py <span class=s2>&#34;人像照片&#34;</span> -r 4K -a 9:16
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 以图生图</span>
</span></span><span class=line><span class=cl>python ~/.claude/skills/image-generator-hybrid/scripts/generate.py <span class=s2>&#34;转换为赛博朋克风格&#34;</span> -i input.jpg
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 仅保存最高分辨率</span>
</span></span><span class=line><span class=cl>python ~/.claude/skills/image-generator-hybrid/scripts/generate.py <span class=s2>&#34;风景&#34;</span> --select max_res
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 自定义输出位置</span>
</span></span><span class=line><span class=cl>python ~/.claude/skills/image-generator-hybrid/scripts/generate.py <span class=s2>&#34;猫咪&#34;</span> -o ./images --mkdir --output-name cat
</span></span></code></pre></div><h4 id=二准备claudeskills目录结构>二、准备claude/skills目录结构<a hidden class=anchor aria-hidden=true href=#二准备claudeskills目录结构>#</a></h4><p>在 ~/.claude/新建skills/gen-image目录，在gen-image下建scripts目录，把python文件放进去</p><p><img alt=image-20251231133443102 loading=lazy src=/posts/20251231-claude_skills/image-20251231133443102.png></p><h4 id=三准备skillmd文件>三、准备SKILL.md文件<a hidden class=anchor aria-hidden=true href=#三准备skillmd文件>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>---
</span></span><span class=line><span class=cl>name: gen-image
</span></span><span class=line><span class=cl>description: 同时支持 SDK 与 HTTP 两种方式生成图片，可按需切换保存策略。
</span></span><span class=line><span class=cl>allowed-tools: Bash<span class=o>(</span>python:*<span class=o>)</span>
</span></span><span class=line><span class=cl>---
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Image Generator (Hybrid) Skill</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>一个脚本同时支持 SDK 与 HTTP 直连两种模式。
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## 配置</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>- **API 端点**: <span class=sb>`</span>http://127.0.0.1:8317/v1beta/models/gemini-3-pro-image-preview:generateContent<span class=sb>`</span>
</span></span><span class=line><span class=cl>- **模型**: <span class=sb>`</span>gemini-3-pro-image-preview<span class=sb>`</span>
</span></span><span class=line><span class=cl>- **API Key**: <span class=sb>`</span>key<span class=sb>`</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>可通过环境变量覆盖默认配置：
</span></span><span class=line><span class=cl>- <span class=sb>`</span>IMAGE_API_KEY<span class=sb>`</span>: API 密钥
</span></span><span class=line><span class=cl>- <span class=sb>`</span>IMAGE_MODEL<span class=sb>`</span>: 使用的模型名称
</span></span><span class=line><span class=cl>- <span class=sb>`</span>IMAGE_API_BASE_URL<span class=sb>`</span>: API 基础地址
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## 参数</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>- <span class=sb>`</span>--mode<span class=sb>`</span>: <span class=sb>`</span>sdk<span class=p>|</span>http<span class=sb>`</span>（默认 <span class=sb>`</span>sdk<span class=sb>`</span>）
</span></span><span class=line><span class=cl>- <span class=sb>`</span>-r/--resolution<span class=sb>`</span>: <span class=sb>`</span>1K<span class=p>|</span>2K<span class=p>|</span>4K<span class=sb>`</span>
</span></span><span class=line><span class=cl>- <span class=sb>`</span>-a/--aspect-ratio<span class=sb>`</span>: <span class=sb>`</span>1:1<span class=p>|</span>2:3<span class=p>|</span>3:2<span class=p>|</span>3:4<span class=p>|</span>4:3<span class=p>|</span>4:5<span class=p>|</span>5:4<span class=p>|</span>9:16<span class=p>|</span>16:9<span class=p>|</span>21:9<span class=sb>`</span>
</span></span><span class=line><span class=cl>- <span class=sb>`</span>-i/--input-image<span class=sb>`</span>: 以图生图输入图片路径
</span></span><span class=line><span class=cl>- <span class=sb>`</span>--select<span class=sb>`</span>: <span class=sb>`</span>all<span class=p>|</span>first<span class=p>|</span>last<span class=p>|</span>max_res<span class=sb>`</span>
</span></span><span class=line><span class=cl>  - <span class=sb>`</span>max_res<span class=sb>`</span> 会选择返回中“最大体积”的那张（通常是 4K）
</span></span><span class=line><span class=cl>- <span class=sb>`</span>-o/--output-dir<span class=sb>`</span>: 输出目录（默认当前目录）
</span></span><span class=line><span class=cl>- <span class=sb>`</span>--output-name<span class=sb>`</span>: 指定文件名（可选；若返回多张，自动追加 <span class=sb>`</span>_1/_2<span class=sb>`</span>）
</span></span><span class=line><span class=cl>- <span class=sb>`</span>--mkdir<span class=sb>`</span>: 当输出目录不存在时创建（默认 false）；否则回退到当前目录
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## 使用</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=sb>```</span>bash
</span></span><span class=line><span class=cl><span class=c1># SDK 模式（默认）</span>
</span></span><span class=line><span class=cl>python ~/.claude/skills/gen-image/scripts/generate.py <span class=s2>&#34;描述&#34;</span> -r 4K -a 16:9
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># HTTP 模式（保存全部返回图片）</span>
</span></span><span class=line><span class=cl>python ~/.claude/skills/gen-image/scripts/generate.py <span class=s2>&#34;描述&#34;</span> --mode http -r 4K -a 1:1 --select all
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 仅保存最大尺寸</span>
</span></span><span class=line><span class=cl>python ~/.claude/skills/gen-image/scripts/generate.py <span class=s2>&#34;描述&#34;</span> --mode http -r 4K -a 1:1 --select max_res
</span></span><span class=line><span class=cl><span class=sb>```</span>
</span></span></code></pre></div><p>看明白了吧，这个markdown 描述了这个技能的情况，配置、参数、使用</p><p>最厉害的是claude会根据这个markdown文件来自动调用这个脚本，自己匹配合适的参数，这才是最厉害的地方</p><p>那每个SKILL都是一个md文件，给个模板：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 技能名称</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>简单说明这个技能是干嘛用的，一般在什么情况下会用到。
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## 什么时候用</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>- 场景1：比如要上线新版本时
</span></span><span class=line><span class=cl>- 场景2：比如遇到某个特定错误时
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## 具体步骤</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>1. 第一步要做什么（附上具体的命令）
</span></span><span class=line><span class=cl>2. 第二步...
</span></span><span class=line><span class=cl>3. 依次往下
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## 怎么确认成功了</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>做完之后，通过哪些方法可以验证操作是成功的。
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>## 可能遇到的问题</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>- 问题1：如果遇到...，可以试试...
</span></span><span class=line><span class=cl>- 问题2：有时候会...，这时候应该...
</span></span></code></pre></div><h4 id=四配置claude>四、配置Claude<a hidden class=anchor aria-hidden=true href=#四配置claude>#</a></h4><p>在CLAUDE.md中添加</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1>## 生图 生成图片</span>
</span></span><span class=line><span class=cl>   使用技能 ~/.claude/skills/gen-image
</span></span></code></pre></div><p>然后就可以在claude里面使用了</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>生图，4K，1:1，随机内容，仅保留最大分辨率，输出在当前目录，文件名：001.png 
</span></span></code></pre></div><h4 id=五发散思维>五、发散思维<a hidden class=anchor aria-hidden=true href=#五发散思维>#</a></h4><p>这个是用的gemini的模型，那改改程序，用前面文章提供的接口：</p><p><a href=/posts/20251230-img_router>魔搭、模力方舟、豆包免费文生图</a></p><p>就可以随便生图了</p></div><footer class=post-footer><ul class=post-tags></ul></footer></article></main><footer class=footer><span>Copyright © 2020-2025 Zhang Ranrui. All Rights Reserved.</span><br>·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script></body></html>